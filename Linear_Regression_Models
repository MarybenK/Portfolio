
      "source": [
        "Linear regression models."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "id": "80b7dd15-8c28-4348-8133-05abe2ed99c4",
      "metadata": {
        "id": "80b7dd15-8c28-4348-8133-05abe2ed99c4"
      },
      "outputs": [],
      "source": [
        "# Crucial data processing and analysis libraries\n",
        "import numpy as np\n",
        "import pandas as pd\n",
        "\n",
        "# We use Plotly for visualizations\n",
        "import plotly.express as px\n",
        "import plotly.graph_objects as go\n",
        "\n",
        "# Loading the modules required to build and evaluate a linear regression model\n",
        "from sklearn.linear_model import LinearRegression\n",
        "from sklearn.model_selection import train_test_split\n",
        "from sklearn.metrics import r2_score, mean_squared_error\n",
        "\n",
        "# Loading the California housing dataset from sklearn\n",
        "from sklearn.datasets import fetch_california_housing"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "7f1d16cc-646c-4907-92e4-c510c530b44a",
      "metadata": {
        "id": "7f1d16cc-646c-4907-92e4-c510c530b44a"
      },
      "source": [
        "##### Loading the California housing dataset"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "id": "037fe141-1b1c-4d14-a7fb-df458c3ff8d9",
      "metadata": {
        "id": "037fe141-1b1c-4d14-a7fb-df458c3ff8d9"
      },
      "outputs": [],
      "source": [
        "# Load the dataset\n",
        "california = fetch_california_housing()"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "1fd68f26-6a50-43a9-8e12-dfec2c7e761a",
      "metadata": {
        "id": "1fd68f26-6a50-43a9-8e12-dfec2c7e761a"
      },
      "source": [
        "Let's explore what the the data is:"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 3,
      "id": "cb3b67a2-9dcc-4cb5-bac0-41f86ba83c47",
      "metadata": {
        "id": "cb3b67a2-9dcc-4cb5-bac0-41f86ba83c47",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "ba0cc9b0-11c3-4480-945a-49d48c2ea134"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            ".. _california_housing_dataset:\n",
            "\n",
            "California Housing dataset\n",
            "--------------------------\n",
            "\n",
            "**Data Set Characteristics:**\n",
            "\n",
            ":Number of Instances: 20640\n",
            "\n",
            ":Number of Attributes: 8 numeric, predictive attributes and the target\n",
            "\n",
            ":Attribute Information:\n",
            "    - MedInc        median income in block group\n",
            "    - HouseAge      median house age in block group\n",
            "    - AveRooms      average number of rooms per household\n",
            "    - AveBedrms     average number of bedrooms per household\n",
            "    - Population    block group population\n",
            "    - AveOccup      average number of household members\n",
            "    - Latitude      block group latitude\n",
            "    - Longitude     block group longitude\n",
            "\n",
            ":Missing Attribute Values: None\n",
            "\n",
            "This dataset was obtained from the StatLib repository.\n",
            "https://www.dcc.fc.up.pt/~ltorgo/Regression/cal_housing.html\n",
            "\n",
            "The target variable is the median house value for California districts,\n",
            "expressed in hundreds of thousands of dollars ($100,000).\n",
            "\n",
            "This dataset was derived from the 1990 U.S. census, using one row per census\n",
            "block group. A block group is the smallest geographical unit for which the U.S.\n",
            "Census Bureau publishes sample data (a block group typically has a population\n",
            "of 600 to 3,000 people).\n",
            "\n",
            "A household is a group of people residing within a home. Since the average\n",
            "number of rooms and bedrooms in this dataset are provided per household, these\n",
            "columns may take surprisingly large values for block groups with few households\n",
            "and many empty houses, such as vacation resorts.\n",
            "\n",
            "It can be downloaded/loaded using the\n",
            ":func:`sklearn.datasets.fetch_california_housing` function.\n",
            "\n",
            ".. rubric:: References\n",
            "\n",
            "- Pace, R. Kelley and Ronald Barry, Sparse Spatial Autoregressions,\n",
            "  Statistics and Probability Letters, 33 (1997) 291-297\n",
            "\n"
          ]
        }
      ],
      "source": [
        "print(california.DESCR)"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "##### Preparing the data"
      ],
      "metadata": {
        "id": "eM0l9wA6kGRU"
      },
      "id": "eM0l9wA6kGRU"
    },
    {
      "cell_type": "code",
      "source": [
        "# Define X and y, Select the first 1000 examples\n",
        "X = california.data[:1000]\n",
        "y = california.target[:1000]\n",
        "\n",
        "# Convert the data to a DataFrame\n",
        "df = pd.DataFrame(data=np.c_[X, y], columns=california.feature_names + ['MedHouseVal'])"
      ],
      "metadata": {
        "id": "m8IiAN0rkAwv"
      },
      "id": "m8IiAN0rkAwv",
      "execution_count": 4,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "...and take a look at it:"
      ],
      "metadata": {
        "id": "J1GCU-tckQC5"
      },
      "id": "J1GCU-tckQC5"
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "id": "676f6c37-7cf7-4799-9663-963a05b70cc7",
      "metadata": {
        "id": "676f6c37-7cf7-4799-9663-963a05b70cc7",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "outputId": "58d9dc3b-5d2e-452f-ea00-8229ecced3a5"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "     MedInc  HouseAge  AveRooms  AveBedrms  Population  AveOccup  Latitude  \\\n",
              "0    8.3252      41.0  6.984127   1.023810       322.0  2.555556     37.88   \n",
              "1    8.3014      21.0  6.238137   0.971880      2401.0  2.109842     37.86   \n",
              "2    7.2574      52.0  8.288136   1.073446       496.0  2.802260     37.85   \n",
              "3    5.6431      52.0  5.817352   1.073059       558.0  2.547945     37.85   \n",
              "4    3.8462      52.0  6.281853   1.081081       565.0  2.181467     37.85   \n",
              "..      ...       ...       ...        ...         ...       ...       ...   \n",
              "995  4.8624      11.0  5.680000   1.044706      5826.0  2.741647     37.71   \n",
              "996  9.1531      25.0  5.811765   0.952941       254.0  2.988235     37.74   \n",
              "997  4.7361      22.0  6.080220   1.036264      2474.0  2.718681     37.70   \n",
              "998  5.4324      17.0  5.975831   0.965257      2222.0  3.356495     37.69   \n",
              "999  4.9375      12.0  5.974922   1.100313       802.0  2.514107     37.69   \n",
              "\n",
              "     Longitude  MedHouseVal  \n",
              "0      -122.23        4.526  \n",
              "1      -122.22        3.585  \n",
              "2      -122.24        3.521  \n",
              "3      -122.25        3.413  \n",
              "4      -122.25        3.422  \n",
              "..         ...          ...  \n",
              "995    -121.75        1.924  \n",
              "996    -121.77        4.188  \n",
              "997    -121.80        2.168  \n",
              "998    -121.80        2.155  \n",
              "999    -121.82        2.277  \n",
              "\n",
              "[1000 rows x 9 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-cfffeb2f-9aa0-468f-a53d-b3b915095e5b\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>MedInc</th>\n",
              "      <th>HouseAge</th>\n",
              "      <th>AveRooms</th>\n",
              "      <th>AveBedrms</th>\n",
              "      <th>Population</th>\n",
              "      <th>AveOccup</th>\n",
              "      <th>Latitude</th>\n",
              "      <th>Longitude</th>\n",
              "      <th>MedHouseVal</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>8.3252</td>\n",
              "      <td>41.0</td>\n",
              "      <td>6.984127</td>\n",
              "      <td>1.023810</td>\n",
              "      <td>322.0</td>\n",
              "      <td>2.555556</td>\n",
              "      <td>37.88</td>\n",
              "      <td>-122.23</td>\n",
              "      <td>4.526</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>8.3014</td>\n",
              "      <td>21.0</td>\n",
              "      <td>6.238137</td>\n",
              "      <td>0.971880</td>\n",
              "      <td>2401.0</td>\n",
              "      <td>2.109842</td>\n",
              "      <td>37.86</td>\n",
              "      <td>-122.22</td>\n",
              "      <td>3.585</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>7.2574</td>\n",
              "      <td>52.0</td>\n",
              "      <td>8.288136</td>\n",
              "      <td>1.073446</td>\n",
              "      <td>496.0</td>\n",
              "      <td>2.802260</td>\n",
              "      <td>37.85</td>\n",
              "      <td>-122.24</td>\n",
              "      <td>3.521</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>5.6431</td>\n",
              "      <td>52.0</td>\n",
              "      <td>5.817352</td>\n",
              "      <td>1.073059</td>\n",
              "      <td>558.0</td>\n",
              "      <td>2.547945</td>\n",
              "      <td>37.85</td>\n",
              "      <td>-122.25</td>\n",
              "      <td>3.413</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>3.8462</td>\n",
              "      <td>52.0</td>\n",
              "      <td>6.281853</td>\n",
              "      <td>1.081081</td>\n",
              "      <td>565.0</td>\n",
              "      <td>2.181467</td>\n",
              "      <td>37.85</td>\n",
              "      <td>-122.25</td>\n",
              "      <td>3.422</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>995</th>\n",
              "      <td>4.8624</td>\n",
              "      <td>11.0</td>\n",
              "      <td>5.680000</td>\n",
              "      <td>1.044706</td>\n",
              "      <td>5826.0</td>\n",
              "      <td>2.741647</td>\n",
              "      <td>37.71</td>\n",
              "      <td>-121.75</td>\n",
              "      <td>1.924</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>996</th>\n",
              "      <td>9.1531</td>\n",
              "      <td>25.0</td>\n",
              "      <td>5.811765</td>\n",
              "      <td>0.952941</td>\n",
              "      <td>254.0</td>\n",
              "      <td>2.988235</td>\n",
              "      <td>37.74</td>\n",
              "      <td>-121.77</td>\n",
              "      <td>4.188</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>997</th>\n",
              "      <td>4.7361</td>\n",
              "      <td>22.0</td>\n",
              "      <td>6.080220</td>\n",
              "      <td>1.036264</td>\n",
              "      <td>2474.0</td>\n",
              "      <td>2.718681</td>\n",
              "      <td>37.70</td>\n",
              "      <td>-121.80</td>\n",
              "      <td>2.168</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>998</th>\n",
              "      <td>5.4324</td>\n",
              "      <td>17.0</td>\n",
              "      <td>5.975831</td>\n",
              "      <td>0.965257</td>\n",
              "      <td>2222.0</td>\n",
              "      <td>3.356495</td>\n",
              "      <td>37.69</td>\n",
              "      <td>-121.80</td>\n",
              "      <td>2.155</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>999</th>\n",
              "      <td>4.9375</td>\n",
              "      <td>12.0</td>\n",
              "      <td>5.974922</td>\n",
              "      <td>1.100313</td>\n",
              "      <td>802.0</td>\n",
              "      <td>2.514107</td>\n",
              "      <td>37.69</td>\n",
              "      <td>-121.82</td>\n",
              "      <td>2.277</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>1000 rows Ã— 9 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cfffeb2f-9aa0-468f-a53d-b3b915095e5b')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-cfffeb2f-9aa0-468f-a53d-b3b915095e5b button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-cfffeb2f-9aa0-468f-a53d-b3b915095e5b');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-2a57fe47-a6a1-4bb8-8995-d73f23411816\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-2a57fe47-a6a1-4bb8-8995-d73f23411816')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-2a57fe47-a6a1-4bb8-8995-d73f23411816 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "  <div id=\"id_8cebecf2-8ef4-4614-841a-21c02679d500\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_8cebecf2-8ef4-4614-841a-21c02679d500 button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('df');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df",
              "summary": "{\n  \"name\": \"df\",\n  \"rows\": 1000,\n  \"fields\": [\n    {\n      \"column\": \"MedInc\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1.8113489288447813,\n        \"min\": 0.4999,\n        \"max\": 13.499,\n        \"num_unique_values\": 935,\n        \"samples\": [\n          2.15,\n          1.7719,\n          3.0893\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"HouseAge\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 13.184603512042761,\n        \"min\": 2.0,\n        \"max\": 52.0,\n        \"num_unique_values\": 51,\n        \"samples\": [\n          12.0,\n          13.0,\n          9.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"AveRooms\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1.1717389958289832,\n        \"min\": 1.7142857142857142,\n        \"max\": 9.210227272727273,\n        \"num_unique_values\": 996,\n        \"samples\": [\n          5.504983388704319,\n          5.117647058823529,\n          3.8949152542372882\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"AveBedrms\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.107237603695644,\n        \"min\": 0.5714285714285714,\n        \"max\": 2.7007299270072993,\n        \"num_unique_values\": 956,\n        \"samples\": [\n          1.06198347107438,\n          0.9183168316831684,\n          1.0950510604870385\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Population\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 996.6897034704452,\n        \"min\": 18.0,\n        \"max\": 12203.0,\n        \"num_unique_values\": 783,\n        \"samples\": [\n          1198.0,\n          1625.0,\n          706.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"AveOccup\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.7298003172639722,\n        \"min\": 1.4371405094494658,\n        \"max\": 12.23404255319149,\n        \"num_unique_values\": 991,\n        \"samples\": [\n          2.832547169811321,\n          2.386861313868613,\n          2.4565217391304346\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Latitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.09757017494623572,\n        \"min\": 37.47,\n        \"max\": 37.9,\n        \"num_unique_values\": 44,\n        \"samples\": [\n          37.55,\n          37.63,\n          37.66\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Longitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.1162997124808276,\n        \"min\": -122.34,\n        \"max\": -121.61,\n        \"num_unique_values\": 57,\n        \"samples\": [\n          -122.23,\n          -122.27,\n          -122.04\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"MedHouseVal\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.8903784354525126,\n        \"min\": 0.6,\n        \"max\": 5.00001,\n        \"num_unique_values\": 781,\n        \"samples\": [\n          1.806,\n          2.056,\n          2.713\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 5
        }
      ],
      "source": [
        "df"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "6570eb28-6b6e-40a0-86b3-506678f744ce",
      "metadata": {
        "id": "6570eb28-6b6e-40a0-86b3-506678f744ce",
        "tags": []
      },
      "source": [
        "## Lab activity 1: linear regression on one variable"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "5fc762cf-ca1f-46e3-a35d-57fb10a1e9cb",
      "metadata": {
        "id": "5fc762cf-ca1f-46e3-a35d-57fb10a1e9cb"
      },
      "source": [
        "The linear regression model is best used when there is a linear or almost linear relationship between your features data ($\\mathbf{X}$) and the your labels ($\\mathbf{y}$). Let's start with just considering one of the features. We need to construct a 1D features data matrix which we will call `X_1d`. The labels `y` will not change:"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "id": "677059f1-daa0-4ddf-aa07-16fe8e2df8ae",
      "metadata": {
        "id": "677059f1-daa0-4ddf-aa07-16fe8e2df8ae",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "8ab1cbcb-95f6-4392-f55c-aee508806b49"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(1000, 8)\n",
            "(1000,)\n"
          ]
        }
      ],
      "source": [
        "# We will only apply linear regression on one of the features.\n",
        "# Here we are selecting the average number of rooms column from our dataset\n",
        "X_1d = X[:, 2]\n",
        "\n",
        "# Reshaping the array to be in the proper format. The X array always has to be 2-dimensional as an input into the model along with a one dimensional target(y) array\n",
        "X_1d = X_1d.reshape(-1, 1)\n",
        "\n",
        "print(X.shape)\n",
        "print(y.shape)"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "c04f440a-93b0-47a5-9386-0a1ff761eee8",
      "metadata": {
        "id": "c04f440a-93b0-47a5-9386-0a1ff761eee8"
      },
      "source": [
        "Let's plot a scatterplot of the average number of roomsvs the median house value:"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 7,
      "id": "dd6df523-a4f9-4f13-a0aa-0065fd368c27",
      "metadata": {
        "id": "dd6df523-a4f9-4f13-a0aa-0065fd368c27",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 542
        },
        "outputId": "0ebf1a72-5824-4b4c-9ea1-e81275a584f5"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/html": [
              "<html>\n",
              "<head><meta charset=\"utf-8\" /></head>\n",
              "<body>\n",
              "    <div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
              "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-2.35.2.min.js\"></script>                <div id=\"11014bcf-a7a5-40db-9710-a51e2537f76c\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"11014bcf-a7a5-40db-9710-a51e2537f76c\")) {                    Plotly.newPlot(                        \"11014bcf-a7a5-40db-9710-a51e2537f76c\",                        [{\"hovertemplate\":\"AveRooms=%{x}\\u003cbr\\u003eMedHouseVal=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#636efa\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"x\":[6.984126984126984,6.238137082601054,8.288135593220339,5.8173515981735155,6.281853281853282,4.761658031088083,4.9319066147859925,4.797527047913447,4.294117647058823,4.970588235294118,5.477611940298507,4.772479564032698,5.322649572649572,4.0,4.262903225806451,4.242424242424242,5.9395770392749245,4.052805280528053,5.343675417661098,5.465454545454546,4.524096385542169,4.478142076502732,5.096234309623431,5.193846153846154,5.270142180094787,4.495798319327731,4.7280334728033475,4.7808564231738035,4.40169133192389,4.703225806451613,5.068783068783069,4.882086167800454,5.737313432835821,5.0303951367781155,4.972014925373134,4.6022727272727275,4.807486631016043,3.7493796526054592,4.757281553398058,3.4942528735632186,4.215189873417722,3.7590361445783134,3.7724867724867726,4.797979797979798,4.941780821917808,4.335078534031414,3.700657894736842,3.9802371541501977,3.9,2.6875,2.045662100456621,4.58968058968059,4.473611111111111,4.075,5.021459227467811,4.295454545454546,4.77992277992278,6.102459016393443,4.5625,2.7719298245614037,5.994652406417113,5.869565217391305,6.229508196721311,7.69811320754717,6.225563909774436,5.401069518716578,4.382530120481928,6.98639455782313,6.975609756097561,4.584288052373159,6.047244094488189,3.375451263537906,5.552631578947368,1.7142857142857142,6.2781954887218046,2.8177676537585423,5.724950884086444,5.830917874396135,5.369230769230769,4.412903225806452,3.1972318339100347,3.75,3.9080459770114944,2.490322580645161,5.609467455621302,6.721739130434782,2.3157894736842106,2.6515151515151514,2.6923076923076925,2.929411764705882,2.74585635359116,2.4431818181818183,2.823529411764706,3.493377483443709,3.6723768736616704,2.294016358157555,3.8949152542372882,3.681318681318681,2.9456,3.7071428571428573,3.7248,3.8784235136940546,3.745614035087719,3.5154975530179446,3.281721632196758,6.184426229508197,4.442982456140351,4.165876777251185,4.848189415041783,4.160847880299252,5.628458498023716,3.7270058708414875,3.2530813475760065,4.578034682080925,3.822274881516588,4.3951890034364265,3.0234798314268514,4.040501446480231,6.742627345844504,6.546391752577319,6.851063829787234,7.1063829787234045,6.947890818858561,6.358558558558559,7.11716621253406,5.5303347280334725,6.127348643006263,5.735343383584589,7.631498470948012,6.446064139941691,6.125,8.335051546391753,6.467268623024831,6.6122715404699735,6.978947368421053,7.530805687203792,6.657992565055762,6.977186311787072,6.982954545454546,7.54,5.615384615384615,6.785714285714286,6.957746478873239,5.132246376811594,4.628336755646817,6.200892857142857,6.39935064935065,4.745652173913044,5.183673469387755,5.283495145631068,5.952941176470588,5.65067178502879,4.429193899782135,6.727699530516432,7.7026315789473685,8.972868217054264,7.599388379204893,5.8203125,7.994318181818182,4.333333333333333,5.074285714285714,4.276639344262295,4.851351351351352,4.326639892904953,4.059113300492611,3.2742382271468142,3.5617433414043584,3.1927554980595083,3.804195804195804,3.882608695652174,3.2091836734693877,3.6887052341597797,3.0902394106813995,3.639751552795031,4.368421052631579,4.585014409221902,4.7343283582089555,3.693140794223827,4.638132295719845,4.496259351620948,4.192023633677991,4.209677419354839,4.0561224489795915,4.20722891566265,4.4714285714285715,4.844029244516653,4.327669902912621,3.7984790874524714,3.776349614395887,4.528052805280528,4.011904761904762,4.554621848739496,3.1818181818181817,3.747967479674797,3.973568281938326,3.510355029585799,2.8333333333333335,4.38996138996139,4.202185792349726,3.746031746031746,4.046948356807512,4.0251572327044025,3.2420091324200913,3.8666666666666667,3.1158455392809588,4.944606413994169,5.365296803652968,4.479923518164436,4.357142857142857,5.054347826086956,5.466911764705882,4.998540145985402,3.9076923076923076,4.489563567362429,4.306603773584905,4.626707132018209,4.823529411764706,5.284246575342466,4.5813953488372094,4.520725388601036,4.316810344827586,4.524663677130045,6.6923076923076925,5.772388059701493,4.984419263456091,6.088235294117647,5.242063492063492,7.117647058823529,5.837349397590361,5.260869565217392,4.51063829787234,5.1152882205513786,6.5451263537906135,5.986784140969163,4.699551569506727,4.62051282051282,4.2,3.30142566191446,4.462025316455696,4.210416666666666,3.9349736379613356,5.4907063197026025,4.310204081632653,3.6653061224489796,4.865573770491803,4.181818181818182,3.6556016597510372,3.6592592592592594,4.036363636363636,3.38989898989899,4.1653944020356235,4.733333333333333,4.313868613138686,5.0,4.703933747412008,3.4858757062146895,3.6714801444043323,3.543726235741445,5.007448789571694,4.536656891495602,5.4373522458628845,4.659574468085107,4.939153439153439,5.020661157024794,4.399491094147582,6.107142857142857,5.105882352941176,5.585131894484412,6.645333333333333,5.956639566395664,3.021276595744681,5.660287081339713,5.631578947368421,5.400611620795107,5.820754716981132,6.593457943925234,6.410334346504559,4.80078125,4.746268656716418,6.176691729323308,6.948717948717949,7.064024390243903,7.589506172839506,6.528723945094052,5.707865168539326,4.731152204836415,4.877149877149877,5.78169014084507,4.933701657458563,5.396694214876033,5.761467889908257,5.427777777777778,6.052083333333333,5.0094936708860756,5.0062111801242235,5.3628318584070795,4.490140845070423,5.544502617801047,4.921875,4.983050847457627,4.82520325203252,4.569696969696969,5.117516629711751,5.789808917197452,4.402985074626866,5.498637602179836,5.08550185873606,4.953068592057762,4.810502283105023,4.775956284153006,5.782857142857143,4.0,4.484581497797357,5.306590257879656,5.7924528301886795,4.198312236286919,4.556390977443609,4.017991004497751,4.253561253561253,4.244230769230769,5.283950617283951,4.267326732673268,5.327044025157233,4.3983739837398375,4.368852459016393,4.561290322580645,5.32404181184669,4.590909090909091,4.8807017543859645,4.029411764705882,5.223076923076923,3.896135265700483,3.3795620437956204,4.569832402234637,4.319648093841642,4.623853211009174,4.56,4.320224719101123,5.940677966101695,4.125,4.825641025641025,3.83011583011583,3.8076923076923075,7.506666666666667,4.863849765258216,6.307228915662651,4.475524475524476,5.186274509803922,5.465217391304348,4.7952755905511815,5.017191977077364,4.75,5.097510373443983,5.394594594594595,4.926900584795321,6.049668874172186,5.358381502890174,6.7518518518518515,6.27887323943662,7.170616113744076,6.127579737335835,8.26027397260274,7.284403669724771,6.330275229357798,6.603960396039604,8.28,8.258064516129032,6.790123456790123,6.194805194805195,5.666666666666667,5.854984894259819,4.481675392670157,4.637305699481865,4.57037037037037,5.084558823529412,4.698581560283688,4.7011494252873565,5.015037593984962,4.367857142857143,5.324324324324325,5.2,4.876777251184834,5.354166666666667,4.963855421686747,5.102325581395349,5.436440677966102,5.608391608391608,5.962864721485412,4.445972495088409,4.819018404907975,4.053333333333334,4.43542757417103,3.902173913043478,4.538181818181818,5.045112781954887,3.3127705627705626,4.556034482758621,5.334801762114537,6.398692810457517,6.115902964959568,5.520958083832335,5.148936170212766,6.4453125,6.690972222222222,7.56,7.639830508474576,8.067193675889328,8.345205479452055,7.42948717948718,8.209016393442623,6.749253731343283,7.291666666666667,6.273712737127371,6.764705882352941,5.371663244353183,7.436619718309859,7.272058823529412,6.132596685082873,6.2154696132596685,6.662337662337662,7.353174603174603,6.666666666666667,6.390625,6.314356435643564,5.981432360742706,5.4106280193236715,4.613079019073569,4.094545454545455,5.377155172413793,5.763285024154589,5.376146788990826,5.564432989690721,4.978947368421053,4.458823529411765,4.342105263157895,3.3065693430656933,4.173469387755102,5.03,3.8984375,4.5,4.6394366197183095,4.565789473684211,5.563953488372093,4.4961832061068705,3.888675623800384,3.544573643410853,4.387254901960785,4.701970443349754,4.477037037037037,4.122969837587007,3.199771689497717,3.447058823529412,4.251623376623376,4.614457831325301,4.1239092495637,3.386215864759428,5.569105691056911,4.161137440758294,2.5241090146750524,2.436,3.105714285714286,2.922023182297155,3.218,3.857142857142857,4.443804034582133,4.962962962962963,5.348082595870206,4.222602739726027,3.5610098176718092,3.9470404984423677,4.475806451612903,4.794797687861272,5.174418604651163,4.413854351687389,4.564044943820225,4.822368421052632,5.002227171492205,4.956521739130435,5.583798882681564,4.727987421383648,3.897887323943662,4.074906367041199,4.765714285714286,4.846575342465753,4.20985401459854,2.962686567164179,4.404282115869018,5.5581737849779085,5.368029739776952,4.690631808278867,6.876237623762377,5.793220338983051,3.5345211581291758,7.794392523364486,7.512096774193548,6.861016949152543,4.792052980132451,5.001226993865031,6.371165644171779,5.015686274509804,5.43801652892562,4.35064935064935,4.310344827586207,4.621212121212121,5.0245098039215685,4.427038626609442,4.521739130434782,4.0627450980392155,3.5860555826426133,8.282548476454293,7.911111111111111,8.928358208955224,9.210227272727273,8.268292682926829,9.122715404699738,7.740088105726873,7.75,9.0,7.048076923076923,6.21608040201005,5.862934362934363,7.068535825545172,8.123456790123457,5.170403587443946,4.825,4.587131367292225,4.673721340388007,4.8279069767441865,5.784090909090909,5.436708860759493,4.663461538461538,4.837962962962963,5.313207547169811,4.611320754716981,4.0874125874125875,4.156378600823046,4.847953216374269,5.740845070422536,4.048703849175177,4.136666666666667,4.230547550432276,4.13768115942029,4.333333333333333,4.5474006116207955,5.585284280936455,5.188940092165899,4.768595041322314,3.7417943107221006,4.61003861003861,4.844943820224719,5.269360269360269,5.011764705882353,7.034883720930233,5.0774818401937045,3.8742138364779874,3.5902255639097747,4.111111111111111,5.6280373831775705,5.9602272727272725,5.305084745762712,4.139013452914798,6.739130434782608,5.753731343283582,6.102739726027397,5.082810539523212,5.068965517241379,4.934959349593496,6.185542168674699,5.693117408906883,4.907692307692308,6.8557763061074315,4.409298780487805,4.550632911392405,4.65566037735849,4.933970460469157,3.5460122699386503,7.133034379671151,7.0234375,6.693761814744802,6.696296296296296,6.327472527472527,6.619834710743802,7.4203454894433785,6.746594005449591,6.057534246575343,7.256130790190736,7.425714285714286,5.5787545787545785,4.996638655462185,5.484154929577465,6.851301115241636,6.240121580547113,6.51207729468599,6.657794676806084,5.524916943521594,5.699386503067485,6.6292682926829265,5.126353790613718,6.0095238095238095,5.072727272727272,4.899135446685879,4.791549295774648,4.198858230256898,4.173913043478261,5.032119914346895,4.5667953667953665,5.545774647887324,5.795081967213115,4.136585365853659,4.567365269461078,5.37,5.2690909090909095,5.578125,6.66412213740458,5.1875,5.485436893203883,6.060869565217391,7.188811188811189,5.105978260869565,4.972413793103448,4.412987012987013,5.325342465753424,5.381642512077295,4.911475409836066,5.377777777777778,4.494949494949495,5.0847784200385355,4.88,6.224137931034483,4.530120481927711,4.737024221453288,5.158536585365853,4.2133891213389125,4.79467680608365,5.956521739130435,4.970149253731344,4.5958762886597935,3.8656195462478187,4.263852242744063,4.473684210526316,4.333679833679834,6.059880239520958,4.881019830028329,6.1521739130434785,7.392592592592592,7.209068010075566,5.5688775510204085,4.938095238095238,6.631578947368421,5.954545454545454,5.633064516129032,5.213963963963964,4.661849710982659,5.262962962962963,4.273668639053255,3.9214195183776934,3.7404214559386975,5.599264705882353,5.001422475106685,5.453551912568306,5.609195402298851,4.433333333333334,4.132264529058117,3.701399688958009,5.297071129707113,5.907651715039578,5.219269102990033,5.612612612612613,5.438405797101449,6.4104803493449785,4.9035087719298245,4.875555555555556,5.527331189710611,4.848066298342541,4.792613636363637,6.180327868852459,5.204488778054863,5.229681978798586,5.786516853932584,5.415637860082304,5.903394255874674,4.985074626865671,3.857657657657658,5.497528830313015,5.070063694267516,4.82680412371134,4.290322580645161,4.772151898734177,4.027681660899654,4.66,4.62453531598513,5.001865671641791,4.309153713298791,3.8126410835214446,3.8402366863905324,3.7196132596685083,4.633540372670807,3.954692556634304,4.763754045307444,4.718220338983051,6.451612903225806,7.502923976608187,4.267015706806283,5.248995983935743,4.779040404040404,5.769886363636363,6.443322981366459,5.809891808346213,4.211136890951276,5.126074498567335,8.518248175182482,4.29489291598023,3.2434210526315788,4.064935064935065,4.401273885350318,4.166666666666667,4.32037037037037,3.9271948608137044,4.829351535836177,4.172839506172839,4.723214285714286,4.2494623655913975,4.4475,4.052048726467331,4.863753213367609,4.370535714285714,5.8164794007490634,6.432,5.702702702702703,5.461152882205514,5.822274881516588,5.3541147132169575,5.109756097560975,5.5315985130111525,6.072,6.338461538461538,6.1193415637860085,6.0602409638554215,6.0,5.8121546961325965,5.514195583596215,4.9409221902017295,5.401503759398496,4.620535714285714,4.307254623044097,4.03150912106136,4.328451882845188,4.944649446494465,4.233576642335766,5.926470588235294,5.224764468371467,5.258116883116883,4.698717948717949,5.340101522842639,7.0,7.228915662650603,6.299479166666667,3.8841567291311754,4.828214971209213,4.345505617977528,4.45945945945946,3.8629715165511933,4.847593582887701,4.5697940503432495,4.37378640776699,4.604026845637584,4.361607142857143,4.148264984227129,6.141304347826087,6.103092783505154,5.857142857142857,4.218905472636816,5.576923076923077,5.869565217391305,4.421461897356143,5.065868263473054,6.41726618705036,5.633228840125392,5.0,6.48,5.119732785200411,5.055674518201285,4.7103825136612025,5.905994550408719,4.940199335548173,4.815013404825737,5.6103896103896105,5.85140562248996,5.404109589041096,5.323529411764706,5.403225806451613,4.938053097345133,6.955719557195572,5.9,4.73225516621743,4.538277511961723,4.145945945945946,4.6375838926174495,4.9125,4.006151742993849,4.017316017316017,5.248259860788863,5.205673758865248,3.8488372093023258,4.216494845360825,5.2727272727272725,5.987421383647798,5.92,5.624288425047438,5.863636363636363,4.902985074626866,5.099337748344371,6.362745098039215,5.01423487544484,5.738589211618257,5.3534883720930235,4.859459459459459,5.182080924855492,4.5181818181818185,5.729970326409496,5.141280353200883,5.2063615205585725,5.326923076923077,4.678062678062678,5.22258064516129,4.831775700934579,6.305220883534137,4.991769547325103,5.833865814696486,5.724050632911393,5.21479374110953,4.831360946745562,4.931350114416476,4.316666666666666,3.948170731707317,5.664179104477612,5.504983388704319,5.85408560311284,6.016166281755196,6.314565483476132,5.567741935483871,5.115492957746479,4.882575757575758,6.282926829268293,6.157303370786517,5.992537313432836,6.862704918032787,5.3215926493108725,5.502906976744186,6.326007326007326,4.900313971742543,5.339331619537275,3.652037617554859,5.350061199510404,5.624161073825503,4.1923076923076925,5.981969486823855,4.184782608695652,4.850318471337579,5.503168567807351,6.395348837209302,4.231794871794872,5.934020618556701,6.402616279069767,5.689848963821566,5.72409823484267,5.410596026490066,6.270485859318347,6.017804154302671,5.925431274346132,4.6938775510204085,5.0904467853251,5.225572979493365,5.430379746835443,5.390692640692641,5.663313212608987,4.114130434782608,4.177777777777778,4.962546816479401,5.115768463073852,5.66941297631308,5.232388663967611,4.470167064439141,5.032731376975169,6.052795031055901,4.165820642978003,3.833457804331591,3.492905937992643,7.946778711484594,7.030921052631579,6.154545454545454,6.905204460966543,6.891447368421052,6.011965811965812,6.18780487804878,4.608303249097473,4.502032520325203,5.411009174311927,4.052901023890785,4.950749464668094,5.513317191283293,6.172413793103448,5.238888888888889,4.974960876369327,5.772277227722772,5.422087745839637,5.903100775193798,5.328918322295806,5.518024032042724,5.963675213675214,5.381834215167548,6.511392405063291,5.350140056022409,6.019108280254777,5.85590465872156,6.135399673735726,6.613095238095238,5.508948545861298,5.234600262123198,5.350828729281768,5.737057220708447,5.7625,7.63523372061605,8.306260575296108,5.0757162346521145,6.924558587479936,5.647058823529412,7.075,6.529202279202279,6.391304347826087,6.155339805825243,5.689655172413793,5.987197724039829,5.160388821385176,5.008988764044944,4.07,6.116037735849057,5.523668639053255,4.566510172143975,4.9593147751606,5.254237288135593,5.124137931034483,4.321782178217822,6.44851904090268,6.284875183553598,4.826747720364741,4.96480743691899,6.751091703056769,6.523099850968704,5.94392523364486,6.31981981981982,5.990062111801242,6.67319587628866,7.60075329566855,6.153846153846154,7.915,6.694096601073345,6.634080717488789,7.557077625570776,5.385964912280702,7.287625418060201,6.938461538461539,6.982692307692307,6.73536299765808,6.59330985915493,7.811188811188811,7.746938775510204,7.053726169844021,6.925925925925926,6.219409282700422,6.894915254237288,7.473684210526316,7.762408462164362,4.2087227414330215,5.117647058823529,6.300813008130081,3.3947939262472886,7.6104651162790695,6.6896969696969695,5.837146702557201,6.517985611510792,6.359838274932614,6.389140271493213,5.678125,7.331775700934579,6.76,5.428571428571429,6.0476190476190474,6.916606757728253,4.9629331184528604,7.447916666666667,6.401433691756273,6.9655172413793105,6.630952380952381,5.2558575445173386,5.68,5.811764705882353,6.08021978021978,5.97583081570997,5.974921630094044],\"xaxis\":\"x\",\"y\":[4.526,3.585,3.521,3.413,3.422,2.697,2.992,2.414,2.267,2.611,2.815,2.418,2.135,1.913,1.592,1.4,1.525,1.555,1.587,1.629,1.475,1.598,1.139,0.997,1.326,1.075,0.938,1.055,1.089,1.32,1.223,1.152,1.104,1.049,1.097,0.972,1.045,1.039,1.914,1.76,1.554,1.5,1.188,1.888,1.844,1.823,1.425,1.375,1.875,1.125,1.719,0.938,0.975,1.042,0.875,0.831,0.875,0.853,0.803,0.6,0.757,0.75,0.861,0.761,0.735,0.784,0.844,0.813,0.85,1.292,0.825,0.952,0.75,0.675,1.375,1.775,1.021,1.083,1.125,1.313,1.625,1.125,1.125,1.375,1.188,0.982,1.188,1.625,1.375,5.00001,1.625,1.375,1.625,1.875,1.792,1.3,1.838,1.25,1.7,1.931,2.578,2.734,2.375,3.5,3.357,3.134,2.685,2.594,2.757,2.25,2.625,2.185,2.55,2.241,2.431,2.316,2.185,2.341,3.276,3.476,3.661,3.35,3.736,3.895,3.911,3.373,2.952,2.923,4.115,3.115,3.259,3.926,3.193,3.333,3.352,3.512,3.689,3.659,3.667,3.628,4.833,3.314,3.235,2.167,2.331,2.964,2.737,2.277,1.996,2.398,2.701,3.021,2.695,3.147,3.901,4.103,3.524,2.873,3.487,2.438,2.115,2.184,2.699,2.188,2.25,2.5,1.714,1.938,1.25,0.975,1.25,1.388,1.167,1.518,1.27,1.286,1.406,1.827,1.469,1.228,1.693,1.266,1.279,1.235,1.119,1.128,1.079,1.375,1.055,0.955,1.161,1.122,0.75,1.125,1.25,1.15,0.95,0.964,0.72,0.713,0.808,1.288,1.125,1.194,1.181,1.225,1.063,1.325,1.227,1.133,1.095,1.647,1.25,1.247,1.367,1.417,1.5,1.388,1.392,1.438,1.565,1.51,2.73,2.171,1.871,2.396,2.297,2.573,2.469,1.799,1.696,2.033,2.634,2.318,1.405,1.26,1.22,1.347,1.394,1.154,1.373,1.37,1.426,1.375,1.117,1.268,1.113,1.148,1.023,1.319,1.191,0.806,0.806,0.888,1.024,0.987,1.0,0.923,0.948,1.02,1.584,1.216,1.291,1.214,1.028,1.6,1.439,1.512,1.644,1.565,2.25,1.742,1.669,1.635,2.53,2.407,2.081,1.981,1.728,3.367,3.182,2.858,2.93,3.71,1.573,1.353,1.367,1.607,1.406,1.44,1.619,1.563,1.76,1.458,1.419,0.907,0.906,1.079,1.07,0.982,0.895,0.938,0.967,0.975,0.973,0.912,0.914,0.962,1.201,1.0,0.947,0.857,0.893,1.014,0.725,0.741,0.7,0.846,0.818,0.814,0.818,0.858,0.871,0.835,0.797,0.834,0.847,0.8,0.764,0.797,0.824,0.977,0.972,1.016,0.865,0.905,1.076,0.842,0.889,0.807,0.871,0.851,0.82,0.828,0.846,0.821,0.893,0.983,0.923,0.888,0.9,0.955,0.917,1.004,0.948,1.643,1.555,1.969,2.791,2.528,2.754,2.5,3.298,1.955,2.559,3.111,3.3,2.489,1.429,1.263,1.358,1.306,1.079,1.111,1.22,1.18,0.952,0.943,0.925,0.918,1.094,1.295,1.434,0.982,1.031,2.768,2.709,2.462,2.242,2.291,2.116,2.561,2.063,2.213,2.074,3.5,2.182,2.167,2.706,2.614,2.613,2.322,3.754,3.573,3.744,3.588,4.175,4.305,3.629,3.97,3.468,3.271,2.901,2.92,2.709,3.711,3.356,3.713,3.44,3.422,3.709,3.5,3.686,3.918,4.153,2.849,2.875,2.729,2.596,2.545,2.356,2.184,2.292,1.921,1.793,1.875,1.388,1.5,1.406,1.2,1.448,1.448,2.455,2.0,1.737,1.856,1.826,2.279,2.207,2.12,2.714,2.688,2.778,3.325,3.389,2.875,3.846,3.714,3.5,5.00001,1.75,2.417,2.167,2.113,2.102,1.964,1.917,1.823,1.75,1.659,1.569,1.643,1.5,1.505,1.699,1.474,1.527,1.827,1.793,1.577,1.531,2.5,2.063,2.188,1.982,2.536,2.574,2.895,2.417,4.896,4.462,4.563,3.368,5.00001,5.00001,3.769,3.096,1.823,1.727,1.508,1.536,1.063,1.423,1.194,1.479,1.329,1.325,1.269,1.438,5.00001,5.00001,5.00001,5.00001,4.661,5.00001,4.578,4.716,5.00001,3.986,3.407,2.899,3.353,3.33,2.41,1.896,2.063,2.157,2.102,2.088,1.979,2.013,1.908,2.079,2.153,2.129,2.927,2.75,2.0,1.734,1.022,2.208,2.428,2.654,2.19,2.821,3.72,2.258,2.208,2.345,2.542,3.518,2.75,4.054,2.281,2.34,1.625,2.434,2.738,2.485,2.44,2.409,3.063,2.4,2.471,2.866,2.667,2.298,2.293,2.284,2.062,3.507,2.31,2.529,3.539,2.917,1.0,3.416,4.125,2.486,2.549,2.415,2.952,3.404,2.747,2.386,2.664,3.302,2.068,2.092,1.958,2.535,2.418,2.525,2.639,2.27,2.209,2.593,2.325,2.316,2.094,2.232,2.099,2.082,2.038,1.957,1.905,1.81,1.849,1.908,2.422,1.883,1.835,2.042,2.519,1.875,1.982,2.19,2.75,2.454,1.775,1.716,1.833,1.75,1.567,1.575,1.798,2.055,1.789,2.625,1.65,1.597,1.583,1.448,1.663,1.91,1.75,1.375,1.417,2.109,1.983,1.574,2.647,2.184,2.351,3.418,3.673,2.435,1.679,3.712,2.189,2.027,1.862,1.889,1.8,2.027,1.817,1.668,1.837,2.18,1.915,1.947,1.872,2.231,2.713,1.941,1.904,1.891,1.846,1.973,1.926,1.922,1.946,1.935,2.026,0.833,2.126,1.878,2.057,1.929,2.052,2.134,1.836,1.784,2.192,1.831,1.571,1.578,1.617,1.521,1.449,1.799,1.791,1.599,1.614,1.704,1.375,1.784,1.552,1.609,1.673,3.4,4.31,3.011,2.419,1.625,2.992,3.155,2.168,2.181,1.703,2.75,1.841,1.6,1.75,1.975,1.5,2.056,1.703,1.909,1.969,1.74,1.702,1.809,1.505,1.671,1.489,1.964,1.911,1.875,1.806,1.828,1.793,1.794,2.103,1.923,1.981,1.962,1.816,1.869,1.883,1.84,1.847,1.799,1.672,1.654,1.54,1.535,1.354,1.583,2.407,1.807,2.306,2.108,1.653,2.542,3.326,3.5,1.612,1.793,1.543,1.618,1.619,1.654,1.666,1.497,1.621,1.526,1.952,1.906,1.938,2.006,1.5,1.853,1.727,1.741,1.944,2.067,2.045,1.75,1.375,1.872,1.736,1.63,3.316,1.976,1.979,2.281,1.895,1.842,1.809,1.72,1.779,1.731,1.726,1.821,1.795,1.76,1.926,1.827,1.349,1.576,1.909,1.582,3.5,1.582,1.461,2.267,1.987,2.212,2.085,2.042,1.932,2.095,1.649,1.614,1.87,1.904,1.566,1.573,1.681,1.776,2.089,1.692,1.639,1.647,1.569,1.688,1.741,2.065,2.039,2.17,1.596,1.598,1.543,1.496,1.886,2.385,2.353,2.614,2.344,2.317,1.563,2.22,2.544,2.443,2.47,2.365,1.514,2.137,2.436,2.125,2.147,2.132,2.56,2.375,1.781,2.318,1.479,1.917,2.476,2.835,2.169,2.825,2.956,2.818,2.698,2.312,3.183,2.534,2.782,3.0,2.735,2.234,2.145,2.202,2.403,1.58,2.242,1.772,2.161,2.697,2.312,1.625,2.54,1.962,1.894,2.208,2.138,4.429,3.334,3.524,3.053,2.596,2.489,3.56,2.36,2.188,2.28,2.359,2.032,1.97,2.364,2.232,2.227,2.25,2.401,2.279,2.686,2.751,2.563,3.324,2.876,2.989,2.876,2.222,2.326,2.583,2.309,1.969,2.235,2.239,2.435,4.511,5.00001,1.931,2.644,2.469,3.373,2.848,2.173,2.917,2.238,2.231,2.113,2.185,1.563,2.482,1.86,1.782,1.904,2.103,2.08,1.833,2.457,2.422,1.817,2.994,2.195,2.318,2.213,2.138,2.06,2.711,3.365,3.156,5.00001,2.854,3.23,2.919,2.256,2.596,2.629,2.573,2.592,3.397,3.372,3.341,3.115,2.969,2.479,3.004,3.324,3.898,2.33,2.385,2.333,2.313,4.758,3.932,2.472,2.294,2.825,3.006,2.932,2.785,3.529,4.0,3.75,3.137,1.393,3.275,4.306,1.25,4.5,2.002,1.924,4.188,2.168,2.155,2.277],\"yaxis\":\"y\",\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"AveRooms\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"MedHouseVal\"}},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"Scatterplot of Average Rooms vs. Median House Value\"}},                        {\"responsive\": true}                    ).then(function(){\n",
              "                            \n",
              "var gd = document.getElementById('11014bcf-a7a5-40db-9710-a51e2537f76c');\n",
              "var x = new MutationObserver(function (mutations, observer) {{\n",
              "        var display = window.getComputedStyle(gd).display;\n",
              "        if (!display || display === 'none') {{\n",
              "            console.log([gd, 'removed!']);\n",
              "            Plotly.purge(gd);\n",
              "            observer.disconnect();\n",
              "        }}\n",
              "}});\n",
              "\n",
              "// Listen for the removal of the full notebook cells\n",
              "var notebookContainer = gd.closest('#notebook-container');\n",
              "if (notebookContainer) {{\n",
              "    x.observe(notebookContainer, {childList: true});\n",
              "}}\n",
              "\n",
              "// Listen for the clearing of the current output cell\n",
              "var outputEl = gd.closest('.output');\n",
              "if (outputEl) {{\n",
              "    x.observe(outputEl, {childList: true});\n",
              "}}\n",
              "\n",
              "                        })                };                            </script>        </div>\n",
              "</body>\n",
              "</html>"
            ]
          },
          "metadata": {}
        }
      ],
      "source": [
        "# Create a scatter plot of AveRooms against MedHouseVal\n",
        "fig = px.scatter(df, x='AveRooms', y='MedHouseVal',\n",
        "                 labels={\n",
        "                     \"x\": \"Average Number of Rooms\",\n",
        "                     \"y\": \"Median House Value\"\n",
        "                 },\n",
        "                 title=\"Scatterplot of Average Rooms vs. Median House Value\")\n",
        "\n",
        "fig.show()"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "034d8f94-2c7f-476f-b1d8-22a388bc8a25",
      "metadata": {
        "id": "034d8f94-2c7f-476f-b1d8-22a388bc8a25"
      },
      "source": [
        "##### **[A1]**  \n",
        "Describe the relationship you observe in the data. Zoom in to see more if you have to."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*Start student input* â†“"
      ],
      "metadata": {
        "id": "W0XfLMgFc9-A"
      },
      "id": "W0XfLMgFc9-A"
    },
    {
      "cell_type": "markdown",
      "id": "b74aee9c-1653-4568-b2db-98127d5ab4b4",
      "metadata": {
        "id": "b74aee9c-1653-4568-b2db-98127d5ab4b4"
      },
      "source": [
        "*Put your explanation here.*\n",
        "\n",
        "Looking at the Scatterplot, there is a general positive but weak linear relationship between the average number of rooms and the median house value. As the average number of rooms increases, the median house value tends to rise, but the data points are widely scattered, suggesting that the relationship is not very strong.\n",
        "\n",
        "Main observations from the scattered plot\n",
        "\n",
        "-\tMost data points cluster between 4-7 rooms with house values between $1-3\n",
        "-\tThere are outliers with very high room counts (8+ rooms) but relatively low house values\n",
        "-\tThe data shows high variability at all room counts, suggesting other factors significantly influence house prices\n",
        "-\tThe relationship appears somewhat heteroscedastic, with more spread in house values at higher room counts\n"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*End student input â†‘*"
      ],
      "metadata": {
        "id": "ptNDFalHdO1x"
      },
      "id": "ptNDFalHdO1x"
    },
    {
      "cell_type": "markdown",
      "id": "a6b55bb3-247b-43d7-b41a-3341886b3a37",
      "metadata": {
        "id": "a6b55bb3-247b-43d7-b41a-3341886b3a37"
      },
      "source": [
        "##### **[A2]**  \n",
        "Split your data (`X_1d` and `y`) into train (`_train`) and validation (`_val`) sets, instantiate and fit a [linear regression model](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html) called `lr`."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*Start student input* â†“"
      ],
      "metadata": {
        "id": "xn9i3OIkc-Yx"
      },
      "id": "xn9i3OIkc-Yx"
    },
    {
      "cell_type": "code",
      "execution_count": 24,
      "id": "23c622e9-4639-4f49-be3d-f260b9a6840a",
      "metadata": {
        "id": "23c622e9-4639-4f49-be3d-f260b9a6840a",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 80
        },
        "outputId": "a2e653d1-6ef3-4f61-f4df-32dede0abf30"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "LinearRegression()"
            ],
            "text/html": [
              "<style>#sk-container-id-5 {\n",
              "  /* Definition of color scheme common for light and dark mode */\n",
              "  --sklearn-color-text: #000;\n",
              "  --sklearn-color-text-muted: #666;\n",
              "  --sklearn-color-line: gray;\n",
              "  /* Definition of color scheme for unfitted estimators */\n",
              "  --sklearn-color-unfitted-level-0: #fff5e6;\n",
              "  --sklearn-color-unfitted-level-1: #f6e4d2;\n",
              "  --sklearn-color-unfitted-level-2: #ffe0b3;\n",
              "  --sklearn-color-unfitted-level-3: chocolate;\n",
              "  /* Definition of color scheme for fitted estimators */\n",
              "  --sklearn-color-fitted-level-0: #f0f8ff;\n",
              "  --sklearn-color-fitted-level-1: #d4ebff;\n",
              "  --sklearn-color-fitted-level-2: #b3dbfd;\n",
              "  --sklearn-color-fitted-level-3: cornflowerblue;\n",
              "\n",
              "  /* Specific color for light theme */\n",
              "  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
              "  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n",
              "  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
              "  --sklearn-color-icon: #696969;\n",
              "\n",
              "  @media (prefers-color-scheme: dark) {\n",
              "    /* Redefinition of color scheme for dark theme */\n",
              "    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
              "    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n",
              "    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
              "    --sklearn-color-icon: #878787;\n",
              "  }\n",
              "}\n",
              "\n",
              "#sk-container-id-5 {\n",
              "  color: var(--sklearn-color-text);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 pre {\n",
              "  padding: 0;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 input.sk-hidden--visually {\n",
              "  border: 0;\n",
              "  clip: rect(1px 1px 1px 1px);\n",
              "  clip: rect(1px, 1px, 1px, 1px);\n",
              "  height: 1px;\n",
              "  margin: -1px;\n",
              "  overflow: hidden;\n",
              "  padding: 0;\n",
              "  position: absolute;\n",
              "  width: 1px;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-dashed-wrapped {\n",
              "  border: 1px dashed var(--sklearn-color-line);\n",
              "  margin: 0 0.4em 0.5em 0.4em;\n",
              "  box-sizing: border-box;\n",
              "  padding-bottom: 0.4em;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-container {\n",
              "  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n",
              "     but bootstrap.min.css set `[hidden] { display: none !important; }`\n",
              "     so we also need the `!important` here to be able to override the\n",
              "     default hidden behavior on the sphinx rendered scikit-learn.org.\n",
              "     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n",
              "  display: inline-block !important;\n",
              "  position: relative;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-text-repr-fallback {\n",
              "  display: none;\n",
              "}\n",
              "\n",
              "div.sk-parallel-item,\n",
              "div.sk-serial,\n",
              "div.sk-item {\n",
              "  /* draw centered vertical line to link estimators */\n",
              "  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n",
              "  background-size: 2px 100%;\n",
              "  background-repeat: no-repeat;\n",
              "  background-position: center center;\n",
              "}\n",
              "\n",
              "/* Parallel-specific style estimator block */\n",
              "\n",
              "#sk-container-id-5 div.sk-parallel-item::after {\n",
              "  content: \"\";\n",
              "  width: 100%;\n",
              "  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n",
              "  flex-grow: 1;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-parallel {\n",
              "  display: flex;\n",
              "  align-items: stretch;\n",
              "  justify-content: center;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "  position: relative;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-parallel-item {\n",
              "  display: flex;\n",
              "  flex-direction: column;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-parallel-item:first-child::after {\n",
              "  align-self: flex-end;\n",
              "  width: 50%;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-parallel-item:last-child::after {\n",
              "  align-self: flex-start;\n",
              "  width: 50%;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-parallel-item:only-child::after {\n",
              "  width: 0;\n",
              "}\n",
              "\n",
              "/* Serial-specific style estimator block */\n",
              "\n",
              "#sk-container-id-5 div.sk-serial {\n",
              "  display: flex;\n",
              "  flex-direction: column;\n",
              "  align-items: center;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "  padding-right: 1em;\n",
              "  padding-left: 1em;\n",
              "}\n",
              "\n",
              "\n",
              "/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\n",
              "clickable and can be expanded/collapsed.\n",
              "- Pipeline and ColumnTransformer use this feature and define the default style\n",
              "- Estimators will overwrite some part of the style using the `sk-estimator` class\n",
              "*/\n",
              "\n",
              "/* Pipeline and ColumnTransformer style (default) */\n",
              "\n",
              "#sk-container-id-5 div.sk-toggleable {\n",
              "  /* Default theme specific background. It is overwritten whether we have a\n",
              "  specific estimator or a Pipeline/ColumnTransformer */\n",
              "  background-color: var(--sklearn-color-background);\n",
              "}\n",
              "\n",
              "/* Toggleable label */\n",
              "#sk-container-id-5 label.sk-toggleable__label {\n",
              "  cursor: pointer;\n",
              "  display: flex;\n",
              "  width: 100%;\n",
              "  margin-bottom: 0;\n",
              "  padding: 0.5em;\n",
              "  box-sizing: border-box;\n",
              "  text-align: center;\n",
              "  align-items: start;\n",
              "  justify-content: space-between;\n",
              "  gap: 0.5em;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 label.sk-toggleable__label .caption {\n",
              "  font-size: 0.6rem;\n",
              "  font-weight: lighter;\n",
              "  color: var(--sklearn-color-text-muted);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 label.sk-toggleable__label-arrow:before {\n",
              "  /* Arrow on the left of the label */\n",
              "  content: \"â–¸\";\n",
              "  float: left;\n",
              "  margin-right: 0.25em;\n",
              "  color: var(--sklearn-color-icon);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {\n",
              "  color: var(--sklearn-color-text);\n",
              "}\n",
              "\n",
              "/* Toggleable content - dropdown */\n",
              "\n",
              "#sk-container-id-5 div.sk-toggleable__content {\n",
              "  max-height: 0;\n",
              "  max-width: 0;\n",
              "  overflow: hidden;\n",
              "  text-align: left;\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-toggleable__content.fitted {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-toggleable__content pre {\n",
              "  margin: 0.2em;\n",
              "  border-radius: 0.25em;\n",
              "  color: var(--sklearn-color-text);\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-toggleable__content.fitted pre {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n",
              "  /* Expand drop-down */\n",
              "  max-height: 200px;\n",
              "  max-width: 100%;\n",
              "  overflow: auto;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n",
              "  content: \"â–¾\";\n",
              "}\n",
              "\n",
              "/* Pipeline/ColumnTransformer-specific style */\n",
              "\n",
              "#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
              "  color: var(--sklearn-color-text);\n",
              "  background-color: var(--sklearn-color-unfitted-level-2);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
              "  background-color: var(--sklearn-color-fitted-level-2);\n",
              "}\n",
              "\n",
              "/* Estimator-specific style */\n",
              "\n",
              "/* Colorize estimator box */\n",
              "#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-2);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-2);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-label label.sk-toggleable__label,\n",
              "#sk-container-id-5 div.sk-label label {\n",
              "  /* The background is the default theme color */\n",
              "  color: var(--sklearn-color-text-on-default-background);\n",
              "}\n",
              "\n",
              "/* On hover, darken the color of the background */\n",
              "#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {\n",
              "  color: var(--sklearn-color-text);\n",
              "  background-color: var(--sklearn-color-unfitted-level-2);\n",
              "}\n",
              "\n",
              "/* Label box, darken color on hover, fitted */\n",
              "#sk-container-id-5 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n",
              "  color: var(--sklearn-color-text);\n",
              "  background-color: var(--sklearn-color-fitted-level-2);\n",
              "}\n",
              "\n",
              "/* Estimator label */\n",
              "\n",
              "#sk-container-id-5 div.sk-label label {\n",
              "  font-family: monospace;\n",
              "  font-weight: bold;\n",
              "  display: inline-block;\n",
              "  line-height: 1.2em;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-label-container {\n",
              "  text-align: center;\n",
              "}\n",
              "\n",
              "/* Estimator-specific */\n",
              "#sk-container-id-5 div.sk-estimator {\n",
              "  font-family: monospace;\n",
              "  border: 1px dotted var(--sklearn-color-border-box);\n",
              "  border-radius: 0.25em;\n",
              "  box-sizing: border-box;\n",
              "  margin-bottom: 0.5em;\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-estimator.fitted {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-0);\n",
              "}\n",
              "\n",
              "/* on hover */\n",
              "#sk-container-id-5 div.sk-estimator:hover {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-2);\n",
              "}\n",
              "\n",
              "#sk-container-id-5 div.sk-estimator.fitted:hover {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-2);\n",
              "}\n",
              "\n",
              "/* Specification for estimator info (e.g. \"i\" and \"?\") */\n",
              "\n",
              "/* Common style for \"i\" and \"?\" */\n",
              "\n",
              ".sk-estimator-doc-link,\n",
              "a:link.sk-estimator-doc-link,\n",
              "a:visited.sk-estimator-doc-link {\n",
              "  float: right;\n",
              "  font-size: smaller;\n",
              "  line-height: 1em;\n",
              "  font-family: monospace;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "  border-radius: 1em;\n",
              "  height: 1em;\n",
              "  width: 1em;\n",
              "  text-decoration: none !important;\n",
              "  margin-left: 0.5em;\n",
              "  text-align: center;\n",
              "  /* unfitted */\n",
              "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
              "  color: var(--sklearn-color-unfitted-level-1);\n",
              "}\n",
              "\n",
              ".sk-estimator-doc-link.fitted,\n",
              "a:link.sk-estimator-doc-link.fitted,\n",
              "a:visited.sk-estimator-doc-link.fitted {\n",
              "  /* fitted */\n",
              "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
              "  color: var(--sklearn-color-fitted-level-1);\n",
              "}\n",
              "\n",
              "/* On hover */\n",
              "div.sk-estimator:hover .sk-estimator-doc-link:hover,\n",
              ".sk-estimator-doc-link:hover,\n",
              "div.sk-label-container:hover .sk-estimator-doc-link:hover,\n",
              ".sk-estimator-doc-link:hover {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-3);\n",
              "  color: var(--sklearn-color-background);\n",
              "  text-decoration: none;\n",
              "}\n",
              "\n",
              "div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n",
              ".sk-estimator-doc-link.fitted:hover,\n",
              "div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n",
              ".sk-estimator-doc-link.fitted:hover {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-3);\n",
              "  color: var(--sklearn-color-background);\n",
              "  text-decoration: none;\n",
              "}\n",
              "\n",
              "/* Span, style for the box shown on hovering the info icon */\n",
              ".sk-estimator-doc-link span {\n",
              "  display: none;\n",
              "  z-index: 9999;\n",
              "  position: relative;\n",
              "  font-weight: normal;\n",
              "  right: .2ex;\n",
              "  padding: .5ex;\n",
              "  margin: .5ex;\n",
              "  width: min-content;\n",
              "  min-width: 20ex;\n",
              "  max-width: 50ex;\n",
              "  color: var(--sklearn-color-text);\n",
              "  box-shadow: 2pt 2pt 4pt #999;\n",
              "  /* unfitted */\n",
              "  background: var(--sklearn-color-unfitted-level-0);\n",
              "  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n",
              "}\n",
              "\n",
              ".sk-estimator-doc-link.fitted span {\n",
              "  /* fitted */\n",
              "  background: var(--sklearn-color-fitted-level-0);\n",
              "  border: var(--sklearn-color-fitted-level-3);\n",
              "}\n",
              "\n",
              ".sk-estimator-doc-link:hover span {\n",
              "  display: block;\n",
              "}\n",
              "\n",
              "/* \"?\"-specific style due to the `<a>` HTML tag */\n",
              "\n",
              "#sk-container-id-5 a.estimator_doc_link {\n",
              "  float: right;\n",
              "  font-size: 1rem;\n",
              "  line-height: 1em;\n",
              "  font-family: monospace;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "  border-radius: 1rem;\n",
              "  height: 1rem;\n",
              "  width: 1rem;\n",
              "  text-decoration: none;\n",
              "  /* unfitted */\n",
              "  color: var(--sklearn-color-unfitted-level-1);\n",
              "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 a.estimator_doc_link.fitted {\n",
              "  /* fitted */\n",
              "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
              "  color: var(--sklearn-color-fitted-level-1);\n",
              "}\n",
              "\n",
              "/* On hover */\n",
              "#sk-container-id-5 a.estimator_doc_link:hover {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-3);\n",
              "  color: var(--sklearn-color-background);\n",
              "  text-decoration: none;\n",
              "}\n",
              "\n",
              "#sk-container-id-5 a.estimator_doc_link.fitted:hover {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-3);\n",
              "}\n",
              "</style><div id=\"sk-container-id-5\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" checked><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>LinearRegression</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.linear_model.LinearRegression.html\">?<span>Documentation for LinearRegression</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>LinearRegression()</pre></div> </div></div></div></div>"
            ]
          },
          "metadata": {},
          "execution_count": 24
        }
      ],
      "source": [
        "# Put your code here.\n",
        "'''This code predicts house prices using the trained linear regression model and then evaluates its performance using RÂ² and RMSE.\n",
        "For this activitry, I choose to use stratified split. The California housing dataset has an uneven price distribution, most houses are in the lower-to-middle price range, and only a few are very expensive.\n",
        "If we split the data randomly, the training set might get mostly cheaper houses, while the validation set could contain more expensive ones (or vice versa). Using stratified split will ensure that both training and validation sets have a balanced mix of price categories.\n",
        "This produces a fairer and more accurate evaluation of the modelâ€™s ability to predict housing prices across different market segments'''\n",
        "\n",
        "from sklearn.model_selection import StratifiedShuffleSplit\n",
        "\n",
        "# Combine feature (AveRooms) and target (MedHouseVal) into a DataFrame\n",
        "df_strat = pd.DataFrame(data=np.c_[X_1d, y], columns=['AveRooms', 'MedHouseVal'])\n",
        "\n",
        "# Create price categories for stratified sampling\n",
        "df_strat['price_cat'] = pd.cut(df_strat['MedHouseVal'],\n",
        "                               bins=[0., 1.5, 3.0, 4.5, 6.0],\n",
        "                               labels=[1, 2, 3, 4])\n",
        "\n",
        "# Perform the stratified split\n",
        "split = StratifiedShuffleSplit(n_splits=1, test_size=0.2, random_state=42)\n",
        "for train_index, val_index in split.split(df_strat, df_strat['price_cat']):\n",
        "    strat_train_set = df_strat.loc[train_index]\n",
        "    strat_val_set = df_strat.loc[val_index]\n",
        "\n",
        "# Drop the helper column\n",
        "for dataset in (strat_train_set, strat_val_set):\n",
        "    dataset.drop(\"price_cat\", axis=1, inplace=True)\n",
        "\n",
        "# Separate features and labels\n",
        "X_train = strat_train_set[['AveRooms']].values\n",
        "y_train = strat_train_set['MedHouseVal'].values\n",
        "X_val = strat_val_set[['AveRooms']].values\n",
        "y_val = strat_val_set['MedHouseVal'].values\n",
        "\n",
        "# Instantiate and fit the model\n",
        "lr = LinearRegression()\n",
        "lr.fit(X_train, y_train)\n",
        "\n"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*End student input â†‘*"
      ],
      "metadata": {
        "id": "zaNArep7dN36"
      },
      "id": "zaNArep7dN36"
    },
    {
      "cell_type": "markdown",
      "id": "5e38d130-1f2b-4e07-b63e-df36f2e915a3",
      "metadata": {
        "id": "5e38d130-1f2b-4e07-b63e-df36f2e915a3"
      },
      "source": [
        "##### **[A3]**  \n",
        "Get the weight and bias of our linear function and store them in variables `w` and `b`, respectively. Also, display them.\n",
        "\n",
        "Recall $\\hat{y} = wx + b$, where $w$ is the weight and $b$ is the intercept (bias). The `coef_` attribute of a `LinearRegression` object contains the weights and `intercept_` attribute of a LinearRegression object contains the bias. You can find the documentation [here](https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LinearRegression.html)."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*Start student input* â†“"
      ],
      "metadata": {
        "id": "5UEimBNtc_Dk"
      },
      "id": "5UEimBNtc_Dk"
    },
    {
      "cell_type": "code",
      "execution_count": 20,
      "id": "59115bda-f23c-4449-a654-1ae62d06e1f9",
      "metadata": {
        "id": "59115bda-f23c-4449-a654-1ae62d06e1f9",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "ce70d54b-ef71-4b5e-9ab0-c031e8a60be8"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Weight (w): 0.4391111649409352\n",
            "Bias (b): -0.20985425247634604\n"
          ]
        }
      ],
      "source": [
        "# Put your code here.\n",
        "w = lr.coef_[0]\n",
        "b = lr.intercept_\n",
        "\n",
        "print(f\"Weight (w): {w}\")\n",
        "print(f\"Bias (b): {b}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*End student input â†‘*"
      ],
      "metadata": {
        "id": "4gJ7-jWFdMVq"
      },
      "id": "4gJ7-jWFdMVq"
    },
    {
      "cell_type": "markdown",
      "id": "0b371037-840d-4d18-8610-f5bb3ab7bb09",
      "metadata": {
        "id": "0b371037-840d-4d18-8610-f5bb3ab7bb09"
      },
      "source": [
        "Now, let's plot another scatter plot of our data again and this time add a line of best fit ($\\hat{y} = wx + b$ function)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 13,
      "id": "e65d39f8-7a16-425e-875d-29b8559da168",
      "metadata": {
        "id": "e65d39f8-7a16-425e-875d-29b8559da168",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 542
        },
        "outputId": "0cdd6d24-1adf-403d-e1c6-17550d1ec27e"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/html": [
              "<html>\n",
              "<head><meta charset=\"utf-8\" /></head>\n",
              "<body>\n",
              "    <div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
              "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-2.35.2.min.js\"></script>                <div id=\"6c11fdf5-cabf-4420-aed8-ec5eb56614cd\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"6c11fdf5-cabf-4420-aed8-ec5eb56614cd\")) {                    Plotly.newPlot(                        \"6c11fdf5-cabf-4420-aed8-ec5eb56614cd\",                        [{\"hovertemplate\":\"AveRooms=%{x}\\u003cbr\\u003eMedHouseVal=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#636efa\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"x\":[6.984126984126984,6.238137082601054,8.288135593220339,5.8173515981735155,6.281853281853282,4.761658031088083,4.9319066147859925,4.797527047913447,4.294117647058823,4.970588235294118,5.477611940298507,4.772479564032698,5.322649572649572,4.0,4.262903225806451,4.242424242424242,5.9395770392749245,4.052805280528053,5.343675417661098,5.465454545454546,4.524096385542169,4.478142076502732,5.096234309623431,5.193846153846154,5.270142180094787,4.495798319327731,4.7280334728033475,4.7808564231738035,4.40169133192389,4.703225806451613,5.068783068783069,4.882086167800454,5.737313432835821,5.0303951367781155,4.972014925373134,4.6022727272727275,4.807486631016043,3.7493796526054592,4.757281553398058,3.4942528735632186,4.215189873417722,3.7590361445783134,3.7724867724867726,4.797979797979798,4.941780821917808,4.335078534031414,3.700657894736842,3.9802371541501977,3.9,2.6875,2.045662100456621,4.58968058968059,4.473611111111111,4.075,5.021459227467811,4.295454545454546,4.77992277992278,6.102459016393443,4.5625,2.7719298245614037,5.994652406417113,5.869565217391305,6.229508196721311,7.69811320754717,6.225563909774436,5.401069518716578,4.382530120481928,6.98639455782313,6.975609756097561,4.584288052373159,6.047244094488189,3.375451263537906,5.552631578947368,1.7142857142857142,6.2781954887218046,2.8177676537585423,5.724950884086444,5.830917874396135,5.369230769230769,4.412903225806452,3.1972318339100347,3.75,3.9080459770114944,2.490322580645161,5.609467455621302,6.721739130434782,2.3157894736842106,2.6515151515151514,2.6923076923076925,2.929411764705882,2.74585635359116,2.4431818181818183,2.823529411764706,3.493377483443709,3.6723768736616704,2.294016358157555,3.8949152542372882,3.681318681318681,2.9456,3.7071428571428573,3.7248,3.8784235136940546,3.745614035087719,3.5154975530179446,3.281721632196758,6.184426229508197,4.442982456140351,4.165876777251185,4.848189415041783,4.160847880299252,5.628458498023716,3.7270058708414875,3.2530813475760065,4.578034682080925,3.822274881516588,4.3951890034364265,3.0234798314268514,4.040501446480231,6.742627345844504,6.546391752577319,6.851063829787234,7.1063829787234045,6.947890818858561,6.358558558558559,7.11716621253406,5.5303347280334725,6.127348643006263,5.735343383584589,7.631498470948012,6.446064139941691,6.125,8.335051546391753,6.467268623024831,6.6122715404699735,6.978947368421053,7.530805687203792,6.657992565055762,6.977186311787072,6.982954545454546,7.54,5.615384615384615,6.785714285714286,6.957746478873239,5.132246376811594,4.628336755646817,6.200892857142857,6.39935064935065,4.745652173913044,5.183673469387755,5.283495145631068,5.952941176470588,5.65067178502879,4.429193899782135,6.727699530516432,7.7026315789473685,8.972868217054264,7.599388379204893,5.8203125,7.994318181818182,4.333333333333333,5.074285714285714,4.276639344262295,4.851351351351352,4.326639892904953,4.059113300492611,3.2742382271468142,3.5617433414043584,3.1927554980595083,3.804195804195804,3.882608695652174,3.2091836734693877,3.6887052341597797,3.0902394106813995,3.639751552795031,4.368421052631579,4.585014409221902,4.7343283582089555,3.693140794223827,4.638132295719845,4.496259351620948,4.192023633677991,4.209677419354839,4.0561224489795915,4.20722891566265,4.4714285714285715,4.844029244516653,4.327669902912621,3.7984790874524714,3.776349614395887,4.528052805280528,4.011904761904762,4.554621848739496,3.1818181818181817,3.747967479674797,3.973568281938326,3.510355029585799,2.8333333333333335,4.38996138996139,4.202185792349726,3.746031746031746,4.046948356807512,4.0251572327044025,3.2420091324200913,3.8666666666666667,3.1158455392809588,4.944606413994169,5.365296803652968,4.479923518164436,4.357142857142857,5.054347826086956,5.466911764705882,4.998540145985402,3.9076923076923076,4.489563567362429,4.306603773584905,4.626707132018209,4.823529411764706,5.284246575342466,4.5813953488372094,4.520725388601036,4.316810344827586,4.524663677130045,6.6923076923076925,5.772388059701493,4.984419263456091,6.088235294117647,5.242063492063492,7.117647058823529,5.837349397590361,5.260869565217392,4.51063829787234,5.1152882205513786,6.5451263537906135,5.986784140969163,4.699551569506727,4.62051282051282,4.2,3.30142566191446,4.462025316455696,4.210416666666666,3.9349736379613356,5.4907063197026025,4.310204081632653,3.6653061224489796,4.865573770491803,4.181818181818182,3.6556016597510372,3.6592592592592594,4.036363636363636,3.38989898989899,4.1653944020356235,4.733333333333333,4.313868613138686,5.0,4.703933747412008,3.4858757062146895,3.6714801444043323,3.543726235741445,5.007448789571694,4.536656891495602,5.4373522458628845,4.659574468085107,4.939153439153439,5.020661157024794,4.399491094147582,6.107142857142857,5.105882352941176,5.585131894484412,6.645333333333333,5.956639566395664,3.021276595744681,5.660287081339713,5.631578947368421,5.400611620795107,5.820754716981132,6.593457943925234,6.410334346504559,4.80078125,4.746268656716418,6.176691729323308,6.948717948717949,7.064024390243903,7.589506172839506,6.528723945094052,5.707865168539326,4.731152204836415,4.877149877149877,5.78169014084507,4.933701657458563,5.396694214876033,5.761467889908257,5.427777777777778,6.052083333333333,5.0094936708860756,5.0062111801242235,5.3628318584070795,4.490140845070423,5.544502617801047,4.921875,4.983050847457627,4.82520325203252,4.569696969696969,5.117516629711751,5.789808917197452,4.402985074626866,5.498637602179836,5.08550185873606,4.953068592057762,4.810502283105023,4.775956284153006,5.782857142857143,4.0,4.484581497797357,5.306590257879656,5.7924528301886795,4.198312236286919,4.556390977443609,4.017991004497751,4.253561253561253,4.244230769230769,5.283950617283951,4.267326732673268,5.327044025157233,4.3983739837398375,4.368852459016393,4.561290322580645,5.32404181184669,4.590909090909091,4.8807017543859645,4.029411764705882,5.223076923076923,3.896135265700483,3.3795620437956204,4.569832402234637,4.319648093841642,4.623853211009174,4.56,4.320224719101123,5.940677966101695,4.125,4.825641025641025,3.83011583011583,3.8076923076923075,7.506666666666667,4.863849765258216,6.307228915662651,4.475524475524476,5.186274509803922,5.465217391304348,4.7952755905511815,5.017191977077364,4.75,5.097510373443983,5.394594594594595,4.926900584795321,6.049668874172186,5.358381502890174,6.7518518518518515,6.27887323943662,7.170616113744076,6.127579737335835,8.26027397260274,7.284403669724771,6.330275229357798,6.603960396039604,8.28,8.258064516129032,6.790123456790123,6.194805194805195,5.666666666666667,5.854984894259819,4.481675392670157,4.637305699481865,4.57037037037037,5.084558823529412,4.698581560283688,4.7011494252873565,5.015037593984962,4.367857142857143,5.324324324324325,5.2,4.876777251184834,5.354166666666667,4.963855421686747,5.102325581395349,5.436440677966102,5.608391608391608,5.962864721485412,4.445972495088409,4.819018404907975,4.053333333333334,4.43542757417103,3.902173913043478,4.538181818181818,5.045112781954887,3.3127705627705626,4.556034482758621,5.334801762114537,6.398692810457517,6.115902964959568,5.520958083832335,5.148936170212766,6.4453125,6.690972222222222,7.56,7.639830508474576,8.067193675889328,8.345205479452055,7.42948717948718,8.209016393442623,6.749253731343283,7.291666666666667,6.273712737127371,6.764705882352941,5.371663244353183,7.436619718309859,7.272058823529412,6.132596685082873,6.2154696132596685,6.662337662337662,7.353174603174603,6.666666666666667,6.390625,6.314356435643564,5.981432360742706,5.4106280193236715,4.613079019073569,4.094545454545455,5.377155172413793,5.763285024154589,5.376146788990826,5.564432989690721,4.978947368421053,4.458823529411765,4.342105263157895,3.3065693430656933,4.173469387755102,5.03,3.8984375,4.5,4.6394366197183095,4.565789473684211,5.563953488372093,4.4961832061068705,3.888675623800384,3.544573643410853,4.387254901960785,4.701970443349754,4.477037037037037,4.122969837587007,3.199771689497717,3.447058823529412,4.251623376623376,4.614457831325301,4.1239092495637,3.386215864759428,5.569105691056911,4.161137440758294,2.5241090146750524,2.436,3.105714285714286,2.922023182297155,3.218,3.857142857142857,4.443804034582133,4.962962962962963,5.348082595870206,4.222602739726027,3.5610098176718092,3.9470404984423677,4.475806451612903,4.794797687861272,5.174418604651163,4.413854351687389,4.564044943820225,4.822368421052632,5.002227171492205,4.956521739130435,5.583798882681564,4.727987421383648,3.897887323943662,4.074906367041199,4.765714285714286,4.846575342465753,4.20985401459854,2.962686567164179,4.404282115869018,5.5581737849779085,5.368029739776952,4.690631808278867,6.876237623762377,5.793220338983051,3.5345211581291758,7.794392523364486,7.512096774193548,6.861016949152543,4.792052980132451,5.001226993865031,6.371165644171779,5.015686274509804,5.43801652892562,4.35064935064935,4.310344827586207,4.621212121212121,5.0245098039215685,4.427038626609442,4.521739130434782,4.0627450980392155,3.5860555826426133,8.282548476454293,7.911111111111111,8.928358208955224,9.210227272727273,8.268292682926829,9.122715404699738,7.740088105726873,7.75,9.0,7.048076923076923,6.21608040201005,5.862934362934363,7.068535825545172,8.123456790123457,5.170403587443946,4.825,4.587131367292225,4.673721340388007,4.8279069767441865,5.784090909090909,5.436708860759493,4.663461538461538,4.837962962962963,5.313207547169811,4.611320754716981,4.0874125874125875,4.156378600823046,4.847953216374269,5.740845070422536,4.048703849175177,4.136666666666667,4.230547550432276,4.13768115942029,4.333333333333333,4.5474006116207955,5.585284280936455,5.188940092165899,4.768595041322314,3.7417943107221006,4.61003861003861,4.844943820224719,5.269360269360269,5.011764705882353,7.034883720930233,5.0774818401937045,3.8742138364779874,3.5902255639097747,4.111111111111111,5.6280373831775705,5.9602272727272725,5.305084745762712,4.139013452914798,6.739130434782608,5.753731343283582,6.102739726027397,5.082810539523212,5.068965517241379,4.934959349593496,6.185542168674699,5.693117408906883,4.907692307692308,6.8557763061074315,4.409298780487805,4.550632911392405,4.65566037735849,4.933970460469157,3.5460122699386503,7.133034379671151,7.0234375,6.693761814744802,6.696296296296296,6.327472527472527,6.619834710743802,7.4203454894433785,6.746594005449591,6.057534246575343,7.256130790190736,7.425714285714286,5.5787545787545785,4.996638655462185,5.484154929577465,6.851301115241636,6.240121580547113,6.51207729468599,6.657794676806084,5.524916943521594,5.699386503067485,6.6292682926829265,5.126353790613718,6.0095238095238095,5.072727272727272,4.899135446685879,4.791549295774648,4.198858230256898,4.173913043478261,5.032119914346895,4.5667953667953665,5.545774647887324,5.795081967213115,4.136585365853659,4.567365269461078,5.37,5.2690909090909095,5.578125,6.66412213740458,5.1875,5.485436893203883,6.060869565217391,7.188811188811189,5.105978260869565,4.972413793103448,4.412987012987013,5.325342465753424,5.381642512077295,4.911475409836066,5.377777777777778,4.494949494949495,5.0847784200385355,4.88,6.224137931034483,4.530120481927711,4.737024221453288,5.158536585365853,4.2133891213389125,4.79467680608365,5.956521739130435,4.970149253731344,4.5958762886597935,3.8656195462478187,4.263852242744063,4.473684210526316,4.333679833679834,6.059880239520958,4.881019830028329,6.1521739130434785,7.392592592592592,7.209068010075566,5.5688775510204085,4.938095238095238,6.631578947368421,5.954545454545454,5.633064516129032,5.213963963963964,4.661849710982659,5.262962962962963,4.273668639053255,3.9214195183776934,3.7404214559386975,5.599264705882353,5.001422475106685,5.453551912568306,5.609195402298851,4.433333333333334,4.132264529058117,3.701399688958009,5.297071129707113,5.907651715039578,5.219269102990033,5.612612612612613,5.438405797101449,6.4104803493449785,4.9035087719298245,4.875555555555556,5.527331189710611,4.848066298342541,4.792613636363637,6.180327868852459,5.204488778054863,5.229681978798586,5.786516853932584,5.415637860082304,5.903394255874674,4.985074626865671,3.857657657657658,5.497528830313015,5.070063694267516,4.82680412371134,4.290322580645161,4.772151898734177,4.027681660899654,4.66,4.62453531598513,5.001865671641791,4.309153713298791,3.8126410835214446,3.8402366863905324,3.7196132596685083,4.633540372670807,3.954692556634304,4.763754045307444,4.718220338983051,6.451612903225806,7.502923976608187,4.267015706806283,5.248995983935743,4.779040404040404,5.769886363636363,6.443322981366459,5.809891808346213,4.211136890951276,5.126074498567335,8.518248175182482,4.29489291598023,3.2434210526315788,4.064935064935065,4.401273885350318,4.166666666666667,4.32037037037037,3.9271948608137044,4.829351535836177,4.172839506172839,4.723214285714286,4.2494623655913975,4.4475,4.052048726467331,4.863753213367609,4.370535714285714,5.8164794007490634,6.432,5.702702702702703,5.461152882205514,5.822274881516588,5.3541147132169575,5.109756097560975,5.5315985130111525,6.072,6.338461538461538,6.1193415637860085,6.0602409638554215,6.0,5.8121546961325965,5.514195583596215,4.9409221902017295,5.401503759398496,4.620535714285714,4.307254623044097,4.03150912106136,4.328451882845188,4.944649446494465,4.233576642335766,5.926470588235294,5.224764468371467,5.258116883116883,4.698717948717949,5.340101522842639,7.0,7.228915662650603,6.299479166666667,3.8841567291311754,4.828214971209213,4.345505617977528,4.45945945945946,3.8629715165511933,4.847593582887701,4.5697940503432495,4.37378640776699,4.604026845637584,4.361607142857143,4.148264984227129,6.141304347826087,6.103092783505154,5.857142857142857,4.218905472636816,5.576923076923077,5.869565217391305,4.421461897356143,5.065868263473054,6.41726618705036,5.633228840125392,5.0,6.48,5.119732785200411,5.055674518201285,4.7103825136612025,5.905994550408719,4.940199335548173,4.815013404825737,5.6103896103896105,5.85140562248996,5.404109589041096,5.323529411764706,5.403225806451613,4.938053097345133,6.955719557195572,5.9,4.73225516621743,4.538277511961723,4.145945945945946,4.6375838926174495,4.9125,4.006151742993849,4.017316017316017,5.248259860788863,5.205673758865248,3.8488372093023258,4.216494845360825,5.2727272727272725,5.987421383647798,5.92,5.624288425047438,5.863636363636363,4.902985074626866,5.099337748344371,6.362745098039215,5.01423487544484,5.738589211618257,5.3534883720930235,4.859459459459459,5.182080924855492,4.5181818181818185,5.729970326409496,5.141280353200883,5.2063615205585725,5.326923076923077,4.678062678062678,5.22258064516129,4.831775700934579,6.305220883534137,4.991769547325103,5.833865814696486,5.724050632911393,5.21479374110953,4.831360946745562,4.931350114416476,4.316666666666666,3.948170731707317,5.664179104477612,5.504983388704319,5.85408560311284,6.016166281755196,6.314565483476132,5.567741935483871,5.115492957746479,4.882575757575758,6.282926829268293,6.157303370786517,5.992537313432836,6.862704918032787,5.3215926493108725,5.502906976744186,6.326007326007326,4.900313971742543,5.339331619537275,3.652037617554859,5.350061199510404,5.624161073825503,4.1923076923076925,5.981969486823855,4.184782608695652,4.850318471337579,5.503168567807351,6.395348837209302,4.231794871794872,5.934020618556701,6.402616279069767,5.689848963821566,5.72409823484267,5.410596026490066,6.270485859318347,6.017804154302671,5.925431274346132,4.6938775510204085,5.0904467853251,5.225572979493365,5.430379746835443,5.390692640692641,5.663313212608987,4.114130434782608,4.177777777777778,4.962546816479401,5.115768463073852,5.66941297631308,5.232388663967611,4.470167064439141,5.032731376975169,6.052795031055901,4.165820642978003,3.833457804331591,3.492905937992643,7.946778711484594,7.030921052631579,6.154545454545454,6.905204460966543,6.891447368421052,6.011965811965812,6.18780487804878,4.608303249097473,4.502032520325203,5.411009174311927,4.052901023890785,4.950749464668094,5.513317191283293,6.172413793103448,5.238888888888889,4.974960876369327,5.772277227722772,5.422087745839637,5.903100775193798,5.328918322295806,5.518024032042724,5.963675213675214,5.381834215167548,6.511392405063291,5.350140056022409,6.019108280254777,5.85590465872156,6.135399673735726,6.613095238095238,5.508948545861298,5.234600262123198,5.350828729281768,5.737057220708447,5.7625,7.63523372061605,8.306260575296108,5.0757162346521145,6.924558587479936,5.647058823529412,7.075,6.529202279202279,6.391304347826087,6.155339805825243,5.689655172413793,5.987197724039829,5.160388821385176,5.008988764044944,4.07,6.116037735849057,5.523668639053255,4.566510172143975,4.9593147751606,5.254237288135593,5.124137931034483,4.321782178217822,6.44851904090268,6.284875183553598,4.826747720364741,4.96480743691899,6.751091703056769,6.523099850968704,5.94392523364486,6.31981981981982,5.990062111801242,6.67319587628866,7.60075329566855,6.153846153846154,7.915,6.694096601073345,6.634080717488789,7.557077625570776,5.385964912280702,7.287625418060201,6.938461538461539,6.982692307692307,6.73536299765808,6.59330985915493,7.811188811188811,7.746938775510204,7.053726169844021,6.925925925925926,6.219409282700422,6.894915254237288,7.473684210526316,7.762408462164362,4.2087227414330215,5.117647058823529,6.300813008130081,3.3947939262472886,7.6104651162790695,6.6896969696969695,5.837146702557201,6.517985611510792,6.359838274932614,6.389140271493213,5.678125,7.331775700934579,6.76,5.428571428571429,6.0476190476190474,6.916606757728253,4.9629331184528604,7.447916666666667,6.401433691756273,6.9655172413793105,6.630952380952381,5.2558575445173386,5.68,5.811764705882353,6.08021978021978,5.97583081570997,5.974921630094044],\"xaxis\":\"x\",\"y\":[4.526,3.585,3.521,3.413,3.422,2.697,2.992,2.414,2.267,2.611,2.815,2.418,2.135,1.913,1.592,1.4,1.525,1.555,1.587,1.629,1.475,1.598,1.139,0.997,1.326,1.075,0.938,1.055,1.089,1.32,1.223,1.152,1.104,1.049,1.097,0.972,1.045,1.039,1.914,1.76,1.554,1.5,1.188,1.888,1.844,1.823,1.425,1.375,1.875,1.125,1.719,0.938,0.975,1.042,0.875,0.831,0.875,0.853,0.803,0.6,0.757,0.75,0.861,0.761,0.735,0.784,0.844,0.813,0.85,1.292,0.825,0.952,0.75,0.675,1.375,1.775,1.021,1.083,1.125,1.313,1.625,1.125,1.125,1.375,1.188,0.982,1.188,1.625,1.375,5.00001,1.625,1.375,1.625,1.875,1.792,1.3,1.838,1.25,1.7,1.931,2.578,2.734,2.375,3.5,3.357,3.134,2.685,2.594,2.757,2.25,2.625,2.185,2.55,2.241,2.431,2.316,2.185,2.341,3.276,3.476,3.661,3.35,3.736,3.895,3.911,3.373,2.952,2.923,4.115,3.115,3.259,3.926,3.193,3.333,3.352,3.512,3.689,3.659,3.667,3.628,4.833,3.314,3.235,2.167,2.331,2.964,2.737,2.277,1.996,2.398,2.701,3.021,2.695,3.147,3.901,4.103,3.524,2.873,3.487,2.438,2.115,2.184,2.699,2.188,2.25,2.5,1.714,1.938,1.25,0.975,1.25,1.388,1.167,1.518,1.27,1.286,1.406,1.827,1.469,1.228,1.693,1.266,1.279,1.235,1.119,1.128,1.079,1.375,1.055,0.955,1.161,1.122,0.75,1.125,1.25,1.15,0.95,0.964,0.72,0.713,0.808,1.288,1.125,1.194,1.181,1.225,1.063,1.325,1.227,1.133,1.095,1.647,1.25,1.247,1.367,1.417,1.5,1.388,1.392,1.438,1.565,1.51,2.73,2.171,1.871,2.396,2.297,2.573,2.469,1.799,1.696,2.033,2.634,2.318,1.405,1.26,1.22,1.347,1.394,1.154,1.373,1.37,1.426,1.375,1.117,1.268,1.113,1.148,1.023,1.319,1.191,0.806,0.806,0.888,1.024,0.987,1.0,0.923,0.948,1.02,1.584,1.216,1.291,1.214,1.028,1.6,1.439,1.512,1.644,1.565,2.25,1.742,1.669,1.635,2.53,2.407,2.081,1.981,1.728,3.367,3.182,2.858,2.93,3.71,1.573,1.353,1.367,1.607,1.406,1.44,1.619,1.563,1.76,1.458,1.419,0.907,0.906,1.079,1.07,0.982,0.895,0.938,0.967,0.975,0.973,0.912,0.914,0.962,1.201,1.0,0.947,0.857,0.893,1.014,0.725,0.741,0.7,0.846,0.818,0.814,0.818,0.858,0.871,0.835,0.797,0.834,0.847,0.8,0.764,0.797,0.824,0.977,0.972,1.016,0.865,0.905,1.076,0.842,0.889,0.807,0.871,0.851,0.82,0.828,0.846,0.821,0.893,0.983,0.923,0.888,0.9,0.955,0.917,1.004,0.948,1.643,1.555,1.969,2.791,2.528,2.754,2.5,3.298,1.955,2.559,3.111,3.3,2.489,1.429,1.263,1.358,1.306,1.079,1.111,1.22,1.18,0.952,0.943,0.925,0.918,1.094,1.295,1.434,0.982,1.031,2.768,2.709,2.462,2.242,2.291,2.116,2.561,2.063,2.213,2.074,3.5,2.182,2.167,2.706,2.614,2.613,2.322,3.754,3.573,3.744,3.588,4.175,4.305,3.629,3.97,3.468,3.271,2.901,2.92,2.709,3.711,3.356,3.713,3.44,3.422,3.709,3.5,3.686,3.918,4.153,2.849,2.875,2.729,2.596,2.545,2.356,2.184,2.292,1.921,1.793,1.875,1.388,1.5,1.406,1.2,1.448,1.448,2.455,2.0,1.737,1.856,1.826,2.279,2.207,2.12,2.714,2.688,2.778,3.325,3.389,2.875,3.846,3.714,3.5,5.00001,1.75,2.417,2.167,2.113,2.102,1.964,1.917,1.823,1.75,1.659,1.569,1.643,1.5,1.505,1.699,1.474,1.527,1.827,1.793,1.577,1.531,2.5,2.063,2.188,1.982,2.536,2.574,2.895,2.417,4.896,4.462,4.563,3.368,5.00001,5.00001,3.769,3.096,1.823,1.727,1.508,1.536,1.063,1.423,1.194,1.479,1.329,1.325,1.269,1.438,5.00001,5.00001,5.00001,5.00001,4.661,5.00001,4.578,4.716,5.00001,3.986,3.407,2.899,3.353,3.33,2.41,1.896,2.063,2.157,2.102,2.088,1.979,2.013,1.908,2.079,2.153,2.129,2.927,2.75,2.0,1.734,1.022,2.208,2.428,2.654,2.19,2.821,3.72,2.258,2.208,2.345,2.542,3.518,2.75,4.054,2.281,2.34,1.625,2.434,2.738,2.485,2.44,2.409,3.063,2.4,2.471,2.866,2.667,2.298,2.293,2.284,2.062,3.507,2.31,2.529,3.539,2.917,1.0,3.416,4.125,2.486,2.549,2.415,2.952,3.404,2.747,2.386,2.664,3.302,2.068,2.092,1.958,2.535,2.418,2.525,2.639,2.27,2.209,2.593,2.325,2.316,2.094,2.232,2.099,2.082,2.038,1.957,1.905,1.81,1.849,1.908,2.422,1.883,1.835,2.042,2.519,1.875,1.982,2.19,2.75,2.454,1.775,1.716,1.833,1.75,1.567,1.575,1.798,2.055,1.789,2.625,1.65,1.597,1.583,1.448,1.663,1.91,1.75,1.375,1.417,2.109,1.983,1.574,2.647,2.184,2.351,3.418,3.673,2.435,1.679,3.712,2.189,2.027,1.862,1.889,1.8,2.027,1.817,1.668,1.837,2.18,1.915,1.947,1.872,2.231,2.713,1.941,1.904,1.891,1.846,1.973,1.926,1.922,1.946,1.935,2.026,0.833,2.126,1.878,2.057,1.929,2.052,2.134,1.836,1.784,2.192,1.831,1.571,1.578,1.617,1.521,1.449,1.799,1.791,1.599,1.614,1.704,1.375,1.784,1.552,1.609,1.673,3.4,4.31,3.011,2.419,1.625,2.992,3.155,2.168,2.181,1.703,2.75,1.841,1.6,1.75,1.975,1.5,2.056,1.703,1.909,1.969,1.74,1.702,1.809,1.505,1.671,1.489,1.964,1.911,1.875,1.806,1.828,1.793,1.794,2.103,1.923,1.981,1.962,1.816,1.869,1.883,1.84,1.847,1.799,1.672,1.654,1.54,1.535,1.354,1.583,2.407,1.807,2.306,2.108,1.653,2.542,3.326,3.5,1.612,1.793,1.543,1.618,1.619,1.654,1.666,1.497,1.621,1.526,1.952,1.906,1.938,2.006,1.5,1.853,1.727,1.741,1.944,2.067,2.045,1.75,1.375,1.872,1.736,1.63,3.316,1.976,1.979,2.281,1.895,1.842,1.809,1.72,1.779,1.731,1.726,1.821,1.795,1.76,1.926,1.827,1.349,1.576,1.909,1.582,3.5,1.582,1.461,2.267,1.987,2.212,2.085,2.042,1.932,2.095,1.649,1.614,1.87,1.904,1.566,1.573,1.681,1.776,2.089,1.692,1.639,1.647,1.569,1.688,1.741,2.065,2.039,2.17,1.596,1.598,1.543,1.496,1.886,2.385,2.353,2.614,2.344,2.317,1.563,2.22,2.544,2.443,2.47,2.365,1.514,2.137,2.436,2.125,2.147,2.132,2.56,2.375,1.781,2.318,1.479,1.917,2.476,2.835,2.169,2.825,2.956,2.818,2.698,2.312,3.183,2.534,2.782,3.0,2.735,2.234,2.145,2.202,2.403,1.58,2.242,1.772,2.161,2.697,2.312,1.625,2.54,1.962,1.894,2.208,2.138,4.429,3.334,3.524,3.053,2.596,2.489,3.56,2.36,2.188,2.28,2.359,2.032,1.97,2.364,2.232,2.227,2.25,2.401,2.279,2.686,2.751,2.563,3.324,2.876,2.989,2.876,2.222,2.326,2.583,2.309,1.969,2.235,2.239,2.435,4.511,5.00001,1.931,2.644,2.469,3.373,2.848,2.173,2.917,2.238,2.231,2.113,2.185,1.563,2.482,1.86,1.782,1.904,2.103,2.08,1.833,2.457,2.422,1.817,2.994,2.195,2.318,2.213,2.138,2.06,2.711,3.365,3.156,5.00001,2.854,3.23,2.919,2.256,2.596,2.629,2.573,2.592,3.397,3.372,3.341,3.115,2.969,2.479,3.004,3.324,3.898,2.33,2.385,2.333,2.313,4.758,3.932,2.472,2.294,2.825,3.006,2.932,2.785,3.529,4.0,3.75,3.137,1.393,3.275,4.306,1.25,4.5,2.002,1.924,4.188,2.168,2.155,2.277],\"yaxis\":\"y\",\"type\":\"scatter\"},{\"mode\":\"lines\",\"name\":\"Regression Line\",\"x\":[1.7142857142857142,1.7900022956841137,1.8657188770825133,1.941435458480913,2.0171520398793126,2.092868621277712,2.1685852026761117,2.244301784074511,2.3200183654729107,2.3957349468713103,2.47145152826971,2.5471681096681094,2.622884691066509,2.698601272464909,2.7743178538633084,2.850034435261708,2.9257510166601075,3.001467598058507,3.0771841794569066,3.1529007608553066,3.228617342253706,3.3043339236521057,3.380050505050505,3.4557670864489047,3.5314836678473043,3.607200249245704,3.6829168306441034,3.758633412042503,3.8343499934409024,3.910066574839302,3.9857831562377015,4.061499737636101,4.137216319034501,4.2129329004329,4.2886494818313,4.364366063229699,4.440082644628099,4.515799226026498,4.591515807424899,4.667232388823298,4.742948970221698,4.818665551620097,4.894382133018497,4.970098714416896,5.045815295815296,5.1215318772136955,5.197248458612095,5.272965040010495,5.348681621408894,5.424398202807294,5.500114784205693,5.575831365604093,5.651547947002492,5.727264528400892,5.802981109799292,5.878697691197692,5.954414272596091,6.030130853994491,6.10584743539289,6.18156401679129,6.2572805981896895,6.332997179588089,6.408713760986489,6.484430342384888,6.560146923783288,6.635863505181687,6.711580086580087,6.787296667978486,6.863013249376886,6.938729830775285,7.014446412173685,7.0901629935720845,7.165879574970484,7.2415961563688835,7.317312737767283,7.3930293191656835,7.468745900564083,7.544462481962483,7.620179063360882,7.695895644759282,7.771612226157681,7.847328807556081,7.92304538895448,7.99876197035288,8.074478551751278,8.150195133149678,8.225911714548078,8.301628295946477,8.377344877344877,8.453061458743276,8.528778040141676,8.604494621540075,8.680211202938475,8.755927784336874,8.831644365735274,8.907360947133673,8.983077528532073,9.058794109930474,9.134510691328874,9.210227272727273],\"y\":[0.620639841634627,0.6540573122411425,0.687474782847658,0.7208922534541734,0.7543097240606889,0.7877271946672043,0.8211446652737197,0.8545621358802351,0.8879796064867505,0.921397077093266,0.9548145476997814,0.9882320183062967,1.0216494889128123,1.0550669595193278,1.0884844301258432,1.1219019007323585,1.155319371338874,1.1887368419453894,1.2221543125519048,1.2555717831584206,1.288989253764936,1.3224067243714512,1.3558241949779668,1.3892416655844821,1.4226591361909975,1.456076606797513,1.4894940774040284,1.5229115480105437,1.5563290186170593,1.5897464892235746,1.62316395983009,1.6565814304366056,1.689998901043121,1.7234163716496362,1.7568338422561518,1.7902513128626671,1.8236687834691825,1.857086254075698,1.8905037246822136,1.9239211952887292,1.9573386658952447,1.9907561365017599,2.0241736071082754,2.057591077714791,2.091008548321306,2.1244260189278217,2.1578434895343372,2.1912609601408524,2.224678430747368,2.2580959013538835,2.2915133719603986,2.324930842566914,2.3583483131734297,2.391765783779945,2.425183254386461,2.4586007249929764,2.4920181955994916,2.525435666206007,2.5588531368125227,2.592270607419038,2.6256880780255534,2.659105548632069,2.692523019238584,2.7259404898450996,2.759357960451615,2.7927754310581303,2.826192901664646,2.859610372271161,2.8930278428776766,2.926445313484192,2.9598627840907072,2.993280254697223,3.0266977253037384,3.0601151959102535,3.093532666516769,3.126950137123285,3.1603676077298,3.1937850783363158,3.2272025489428313,3.2606200195493464,3.294037490155862,3.3274549607623776,3.3608724313688927,3.3942899019754083,3.4277073725819234,3.4611248431884385,3.494542313794954,3.5279597844014696,3.5613772550079847,3.5947947256145003,3.628212196221016,3.661629666827531,3.6950471374340466,3.728464608040562,3.7618820786470772,3.795299549253593,3.8287170198601084,3.8621344904666244,3.89555196107314,3.9289694316796555],\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"AveRooms\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"MedHouseVal\"}},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"Scatterplot of Average Rooms vs. Median House Value\"}},                        {\"responsive\": true}                    ).then(function(){\n",
              "                            \n",
              "var gd = document.getElementById('6c11fdf5-cabf-4420-aed8-ec5eb56614cd');\n",
              "var x = new MutationObserver(function (mutations, observer) {{\n",
              "        var display = window.getComputedStyle(gd).display;\n",
              "        if (!display || display === 'none') {{\n",
              "            console.log([gd, 'removed!']);\n",
              "            Plotly.purge(gd);\n",
              "            observer.disconnect();\n",
              "        }}\n",
              "}});\n",
              "\n",
              "// Listen for the removal of the full notebook cells\n",
              "var notebookContainer = gd.closest('#notebook-container');\n",
              "if (notebookContainer) {{\n",
              "    x.observe(notebookContainer, {childList: true});\n",
              "}}\n",
              "\n",
              "// Listen for the clearing of the current output cell\n",
              "var outputEl = gd.closest('.output');\n",
              "if (outputEl) {{\n",
              "    x.observe(outputEl, {childList: true});\n",
              "}}\n",
              "\n",
              "                        })                };                            </script>        </div>\n",
              "</body>\n",
              "</html>"
            ]
          },
          "metadata": {}
        }
      ],
      "source": [
        "# Generate predicted values for the line\n",
        "x_range = np.linspace(X_1d.min(), X_1d.max(), 100)\n",
        "y_range = x_range * w + b\n",
        "\n",
        "# Create a scatter plot of AveRooms against MednHouseVal\n",
        "fig = px.scatter(df, x='AveRooms', y='MedHouseVal',\n",
        "                 labels={\n",
        "                     \"x\": \"Average Number of Rooms\",\n",
        "                     \"y\": \"Median House Value\"\n",
        "                 },\n",
        "                 title=\"Scatterplot of Average Rooms vs. Median House Value\")\n",
        "\n",
        "# Add a regression line\n",
        "fig.add_trace(go.Scatter(x=x_range, y=y_range, mode='lines', name='Regression Line'))\n",
        "\n",
        "# Show the plot\n",
        "fig.show()"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "b044c388-8605-490c-a60b-8d4e87fb1bd9",
      "metadata": {
        "id": "b044c388-8605-490c-a60b-8d4e87fb1bd9"
      },
      "source": [
        "##### **[A4]**  \n",
        "Predict on your `X_val` data and evaluate your model using the [$R^2$ score](https://scikit-learn.org/1.5/modules/generated/sklearn.metrics.r2_score.html) and Root Mean Squared Error ($RMSE$) which is the square root of [Mean Squared Error ($MSE$)](https://scikit-learn.org/1.5/modules/generated/sklearn.metrics.mean_squared_error.html). Display them."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*Start student input* â†“"
      ],
      "metadata": {
        "id": "TY8G_l3KdBem"
      },
      "id": "TY8G_l3KdBem"
    },
    {
      "cell_type": "code",
      "execution_count": 21,
      "id": "a220eb4d-f5ba-4bda-91e0-17cead292af9",
      "metadata": {
        "id": "a220eb4d-f5ba-4bda-91e0-17cead292af9",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "6583b4b0-f5ad-42c1-b83e-60a152115c18"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "RÂ² Score (Stratified Split): 0.3570\n",
            "Root Mean Squared Error (RMSE): 0.7262\n"
          ]
        }
      ],
      "source": [
        "# Put your code here.\n",
        "y_pred = lr.predict(X_val)\n",
        "\n",
        "r2 = r2_score(y_val, y_pred)\n",
        "rmse = np.sqrt(mean_squared_error(y_val, y_pred))\n",
        "\n",
        "print(f\"RÂ² Score (Stratified Split): {r2:.4f}\")\n",
        "print(f\"Root Mean Squared Error (RMSE): {rmse:.4f}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*End student input â†‘*\n"
      ],
      "metadata": {
        "id": "1W1s_tIZdJC2"
      },
      "id": "1W1s_tIZdJC2"
    },
    {
      "cell_type": "markdown",
      "id": "207bff6e-38fa-4196-8c6d-d25d35149e4a",
      "metadata": {
        "id": "207bff6e-38fa-4196-8c6d-d25d35149e4a"
      },
      "source": [
        "## Lab activity 2: multivariate (multilinear) regression"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "b552e537-77be-4cb4-a0ac-31518a7a21dd",
      "metadata": {
        "id": "b552e537-77be-4cb4-a0ac-31518a7a21dd"
      },
      "source": [
        "Fitting a linear model on data with more than one feature is called multilinear regression in statistics. For this activity you will be fitting a regression model with all of the features of the California housing dataset.\n",
        "We will use the original `X` and `y` variables."
      ]
    },
    {
      "cell_type": "markdown",
      "id": "631d81fd-21f3-4b1e-a194-d88846d6cd81",
      "metadata": {
        "id": "631d81fd-21f3-4b1e-a194-d88846d6cd81"
      },
      "source": [
        "##### **[A5]**  \n",
        "Split, instantiate and fit model using all of the features. Reuse `X` and `y`."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*Start student input* â†“"
      ],
      "metadata": {
        "id": "xg0gvnG2dCjx"
      },
      "id": "xg0gvnG2dCjx"
    },
    {
      "cell_type": "code",
      "execution_count": 22,
      "id": "a061e408-0b87-477a-a6b3-9c86fe1f8767",
      "metadata": {
        "id": "a061e408-0b87-477a-a6b3-9c86fe1f8767",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "b9cad068-88d9-44a1-a01e-d881bffaded0"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Training samples: 800, Validation samples: 200\n",
            "Multivariate linear regression model fitted using stratified sampling.\n"
          ]
        }
      ],
      "source": [
        "# Put your code here.\n",
        "# Create a DataFrame for all features and target\n",
        "df_full = pd.DataFrame(data=np.c_[X, y], columns=california.feature_names + ['MedHouseVal'])\n",
        "\n",
        "# Create price categories for stratified sampling\n",
        "df_full['price_cat'] = pd.cut(df_full['MedHouseVal'],\n",
        "                              bins=[0., 1.5, 3.0, 4.5, 6.0],\n",
        "                              labels=[1, 2, 3, 4])\n",
        "\n",
        "# Perform stratified split\n",
        "split = StratifiedShuffleSplit(n_splits=1, test_size=0.2, random_state=42)\n",
        "for train_index, val_index in split.split(df_full, df_full['price_cat']):\n",
        "    strat_train_set = df_full.loc[train_index]\n",
        "    strat_val_set = df_full.loc[val_index]\n",
        "\n",
        "# Drop the helper column\n",
        "for dataset in (strat_train_set, strat_val_set):\n",
        "    dataset.drop(\"price_cat\", axis=1, inplace=True)\n",
        "\n",
        "# Separate features and target\n",
        "X_train = strat_train_set.drop('MedHouseVal', axis=1)\n",
        "y_train = strat_train_set['MedHouseVal']\n",
        "X_val = strat_val_set.drop('MedHouseVal', axis=1)\n",
        "y_val = strat_val_set['MedHouseVal']\n",
        "\n",
        "# Instantiate and fit the model\n",
        "lr_multi = LinearRegression()\n",
        "lr_multi.fit(X_train, y_train)\n",
        "\n",
        "print(f\"Training samples: {len(X_train)}, Validation samples: {len(X_val)}\")\n",
        "print(\"Multivariate linear regression model fitted using stratified sampling.\")"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*End student input â†‘*\n"
      ],
      "metadata": {
        "id": "Xgo2BoicdH8M"
      },
      "id": "Xgo2BoicdH8M"
    },
    {
      "cell_type": "markdown",
      "id": "180ba964-5bce-4c3d-be2b-eecc2677b421",
      "metadata": {
        "id": "180ba964-5bce-4c3d-be2b-eecc2677b421"
      },
      "source": [
        "##### **[A6]**  \n",
        "Predict on your test set you split in this activity and evaluate the model using $R^2$ score and $RMSE$."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*Start student input* â†“"
      ],
      "metadata": {
        "id": "bK2dRnI-dDBG"
      },
      "id": "bK2dRnI-dDBG"
    },
    {
      "cell_type": "code",
      "execution_count": 23,
      "id": "f7a13a6e-9f93-4975-9606-3380013d3f8f",
      "metadata": {
        "id": "f7a13a6e-9f93-4975-9606-3380013d3f8f",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "173ae2ad-435a-4ccb-b266-6d02e705722c"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "RÂ² Score (Multivariate, Stratified Split): 0.5678\n",
            "Root Mean Squared Error (RMSE, Stratified Split): 0.5954\n"
          ]
        }
      ],
      "source": [
        "# Put your code here.\n",
        "\n",
        "# Predict and evaluate\n",
        "y_pred_multi = lr_multi.predict(X_val)\n",
        "\n",
        "r2_multi = r2_score(y_val, y_pred_multi)\n",
        "rmse_multi = np.sqrt(mean_squared_error(y_val, y_pred_multi))\n",
        "\n",
        "print(f\"RÂ² Score (Multivariate, Stratified Split): {r2_multi:.4f}\")\n",
        "print(f\"Root Mean Squared Error (RMSE, Stratified Split): {rmse_multi:.4f}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "*End student input â†‘*\n"
      ],
      "metadata": {
        "id": "64shK0SrdHLi"
      },
      "id": "64shK0SrdHLi"
    }
  ],
  "metadata": {
    "colab": {
      "provenance": []
    },
    "kernelspec": {
      "display_name": "Python 3 (ipykernel)",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.9.7"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}
